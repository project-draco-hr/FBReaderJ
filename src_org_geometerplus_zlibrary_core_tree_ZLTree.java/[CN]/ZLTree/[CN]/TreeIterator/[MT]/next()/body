{
  final T element=myCurrentElement;
  if (element.hasChildren() && element.Level < myMaxLevel) {
    myCurrentElement=(T)((ZLTree<?>)element).mySubTrees.get(0);
    myIndexStack.add(0);
  }
 else {
    ZLTree<T> parent=element;
    while (!myIndexStack.isEmpty()) {
      final int index=myIndexStack.removeLast() + 1;
      parent=parent.Parent;
synchronized (parent.mySubTrees) {
        if (parent.mySubTrees.size() > index) {
          myCurrentElement=parent.mySubTrees.get(index);
          myIndexStack.add(index);
          break;
        }
      }
    }
    if (myIndexStack.isEmpty()) {
      myCurrentElement=null;
    }
  }
  return element;
}

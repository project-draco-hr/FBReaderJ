{
  if (!"https".equalsIgnoreCase(uri.getScheme())) {
    return Collections.singletonMap("error","Connection is not secure");
  }
  if (GooglePlayServicesUtil.isGooglePlayServicesAvailable(getContext()) == ConnectionResult.SUCCESS) {
    final String authUrl=url(uri,params,"auth-url-token");
    final String clientId=params.get("client-id");
    if (authUrl == null || clientId == null) {
      return errorMap("No data for token authentication");
    }
    return authenticateToken(uri,realm,authUrl,clientId);
  }
 else {
    return authenticateWeb(uri,realm,params);
  }
}

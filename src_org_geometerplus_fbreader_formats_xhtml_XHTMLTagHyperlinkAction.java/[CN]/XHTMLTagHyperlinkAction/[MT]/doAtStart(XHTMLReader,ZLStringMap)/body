{
  final BookReader modelReader=reader.getModelReader();
  final String href=xmlattributes.getValue("href");
  if (myHyperlinkStackSize == myHyperlinkStack.length) {
    myHyperlinkStack=ZLArrayUtils.createCopy(myHyperlinkStack,myHyperlinkStackSize,2 * myHyperlinkStackSize);
  }
  if (href != null && href.length() > 0) {
    String link=href;
    final byte hyperlinkType;
    if (isReference(link)) {
      hyperlinkType=FBTextKind.EXTERNAL_HYPERLINK;
    }
 else {
      hyperlinkType=FBTextKind.INTERNAL_HYPERLINK;
      final int index=href.indexOf('#');
      if (index == 0) {
        link=new StringBuilder(reader.myReferencePrefix).append(href,1,href.length()).toString();
      }
 else       if (index > 0) {
        link=new StringBuilder(reader.getLocalFileAlias(href.substring(0,index))).append(href,index,href.length()).toString();
      }
 else {
        link=reader.getLocalFileAlias(href);
      }
    }
    myHyperlinkStack[myHyperlinkStackSize++]=hyperlinkType;
    modelReader.addHyperlinkControl(hyperlinkType,link);
  }
 else {
    myHyperlinkStack[myHyperlinkStackSize++]=FBTextKind.REGULAR;
  }
  final String name=xmlattributes.getValue("name");
  if (name != null) {
    modelReader.addHyperlinkLabel(reader.myReferencePrefix + name);
  }
}

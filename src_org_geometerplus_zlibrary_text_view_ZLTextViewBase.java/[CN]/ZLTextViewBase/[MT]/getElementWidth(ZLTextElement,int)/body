{
  if (element instanceof ZLTextWord) {
    return getWordWidth((ZLTextWord)element,charIndex);
  }
 else   if (element instanceof ZLTextImageElement) {
    final ZLTextImageElement imageElement=(ZLTextImageElement)element;
    final ZLPaintContext.Size size=myContext.imageSize(imageElement.ImageData,getTextAreaSize(),getScalingType(imageElement));
    return size != null ? size.Width : 0;
  }
 else   if (element == ZLTextElement.Indent) {
    return myTextStyle.getFirstLineIndentDelta();
  }
 else   if (element instanceof ZLTextFixedHSpaceElement) {
    return myContext.getSpaceWidth() * ((ZLTextFixedHSpaceElement)element).Length;
  }
  return 0;
}

{
  final BookReference.Type resolvedType=demo ? BookReference.Type.BookDemo : BookReference.Type.Book;
  final BookReference ref=book.reference(resolvedType);
  if (ref != null) {
    final String sslCertificate;
    if (book.Link.authenticationManager() != null) {
      sslCertificate=book.Link.authenticationManager().SSLCertificate;
    }
 else {
      sslCertificate=null;
    }
    activity.startService(new Intent(Intent.ACTION_VIEW,Uri.parse(ref.URL),activity.getApplicationContext(),BookDownloaderService.class).putExtra(BookDownloaderService.BOOK_FORMAT_KEY,ref.BookFormat).putExtra(BookDownloaderService.REFERENCE_TYPE_KEY,resolvedType).putExtra(BookDownloaderService.CLEAN_URL_KEY,ref.cleanURL()).putExtra(BookDownloaderService.TITLE_KEY,book.Title).putExtra(BookDownloaderService.SSL_CERTIFICATE_KEY,sslCertificate));
  }
}

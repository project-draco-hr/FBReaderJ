{
  final NetworkCatalogItem item=((NetworkCatalogTree)tree).Item;
  final NetworkURLCatalogItem urlItem=item instanceof NetworkURLCatalogItem ? (NetworkURLCatalogItem)item : null;
  prepareOptionsItem(menu,RELOAD_ITEM_ID,urlItem != null && urlItem.getUrl(UrlInfo.Type.Catalog) != null && ItemsLoadingService.getRunnable(tree) == null);
  boolean signIn=false;
  boolean signOut=false;
  boolean topup=false;
  String userName=null;
  String account=null;
  NetworkAuthenticationManager mgr=item.Link.authenticationManager();
  if (mgr != null) {
    if (mgr.mayBeAuthorised(false)) {
      userName=mgr.currentUserName();
      signOut=true;
      account=mgr.currentAccount();
      if (account != null && Util.isTopupSupported(activity,item.Link)) {
        topup=true;
      }
    }
 else {
      signIn=true;
    }
  }
  prepareOptionsItem(menu,SIGNIN_ITEM_ID,signIn);
  prepareOptionsItem(menu,SIGNUP_ITEM_ID,signIn & Util.isRegistrationSupported(activity,item.Link));
  prepareOptionsItem(menu,SIGNOUT_ITEM_ID,signOut,"signOut",userName);
  prepareOptionsItem(menu,TOPUP_ITEM_ID,topup);
  return true;
}

{
  if (!startProgressNotification(tree)) {
    return;
  }
  final boolean hadChildren=tree.hasChildren();
  final Handler progressHandler=new Handler(){
    public void handleMessage(    Message message){
      NetworkLibraryItem item=(NetworkLibraryItem)message.obj;
      boolean expand=!tree.hasChildren();
      tree.ChildrenItems.add(item);
      NetworkTreeFactory.createNetworkTree(tree,item);
      tree.updateAccountDependents();
      if (!hasMessages(0)) {
        myAdapter.resetTree();
      }
      if (expand) {
        myAdapter.expandOrCollapseTree(tree);
      }
    }
  }
;
  final Handler finishHandler=new Handler(){
    public void handleMessage(    Message message){
      if (!hadChildren) {
        afterUpdateCatalog((String)message.obj,tree.ChildrenItems.size() == 0);
      }
 else {
        myAdapter.expandOrCollapseTree(tree);
      }
      endProgressNotification(tree);
    }
  }
;
  new Thread(new Runnable(){
    public void run(){
      NetworkCatalogItem item=tree.Item;
      NetworkLink link=item.Link;
      if (link.authenticationManager() != null) {
        NetworkAuthenticationManager mgr=link.authenticationManager();
      }
      String err=null;
      if (!hadChildren) {
        err=tree.Item.loadChildren(new NetworkCatalogItem.CatalogListener(){
          public void onNewItem(          NetworkLibraryItem item){
            progressHandler.sendMessage(progressHandler.obtainMessage(0,item));
          }
        }
);
      }
      finishHandler.sendMessage(finishHandler.obtainMessage(0,err));
    }
  }
).start();
}

{
  if (tree.hasChildren()) {
    myAdapter.expandOrCollapseTree(tree);
    return;
  }
  if (!startProgressNotification(tree)) {
    return;
  }
  final Handler progressHandler=new Handler(){
    public void handleMessage(    Message message){
      NetworkLibraryItem item=(NetworkLibraryItem)message.obj;
      boolean expand=!tree.hasChildren();
      tree.ChildrenItems.add(item);
      NetworkTreeFactory.createNetworkTree(tree,item);
      tree.updateAccountDependents();
      if (item instanceof NetworkCatalogItem) {
        ++dbgCatalogsCounter;
      }
      if (item instanceof NetworkBookItem) {
        ++dbgBooksCounter;
      }
      myAdapter.resetTree();
      if (expand) {
        myAdapter.expandOrCollapseTree(tree);
      }
    }
  }
;
  final Handler finishHandler=new Handler(){
    public void handleMessage(    Message message){
      afterUpdateCatalog((String)message.obj,tree.ChildrenItems.size() == 0);
      endProgressNotification(tree);
      System.err.println("FBREADER -- dbgCatalogsCounter = " + dbgCatalogsCounter);
      System.err.println("FBREADER -- dbgBooksCounter = " + dbgBooksCounter);
    }
  }
;
  new Thread(new Runnable(){
    public void run(){
      NetworkCatalogItem item=tree.Item;
      NetworkLink link=item.Link;
      if (link.authenticationManager() != null) {
        NetworkAuthenticationManager mgr=link.authenticationManager();
      }
      final String err=tree.Item.loadChildren(new NetworkCatalogItem.CatalogListener(){
        public void onNewItem(        NetworkLibraryItem item){
          progressHandler.sendMessage(progressHandler.obtainMessage(0,item));
        }
      }
);
      finishHandler.sendMessage(finishHandler.obtainMessage(0,err));
    }
  }
).start();
}

{
  if (file == null) {
    return null;
  }
synchronized (ourCoverMap) {
    final String path=file.getPath();
    final WeakReference<ZLImage> ref=ourCoverMap.get(path);
    if (ref == NULL_IMAGE) {
      return null;
    }
 else     if (ref != null) {
      final ZLImage image=ref.get();
      if (image != null) {
        return image;
      }
    }
    ZLImage image=null;
    final FormatPlugin plugin=PluginCollection.Instance().getPlugin(file);
    if (plugin != null) {
      image=plugin.readCover(file);
    }
    if (image == null) {
      ourCoverMap.put(path,NULL_IMAGE);
    }
 else {
      ourCoverMap.put(path,new WeakReference<ZLImage>(image));
    }
    return image;
  }
}

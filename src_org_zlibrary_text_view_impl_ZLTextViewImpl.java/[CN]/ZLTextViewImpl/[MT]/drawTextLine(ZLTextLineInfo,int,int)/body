{
  final ZLPaintContext context=getContext();
  final ZLTextParagraphCursor paragraph=info.RealStart.getParagraphCursor();
  context.moveY(info.Height);
  int maxY=getTopMargin() + getTextAreaHeight();
  if (context.getY() > maxY) {
    context.moveYTo(maxY);
  }
  context.moveXTo(getLeftMargin());
  if (info.NodeInfo != null) {
    drawTreeLines(info.NodeInfo,info.Height,info.Descent + info.VSpaceAfter);
  }
  int index=from;
  final int endWordNumber=info.End.getWordNumber();
  int charNumber=info.RealStart.getCharNumber();
  for (int wordNumber=info.RealStart.getWordNumber(); wordNumber != endWordNumber; ++wordNumber, charNumber=0) {
    final ZLTextElement element=paragraph.getElement(wordNumber);
    if ((element instanceof ZLTextWord) || (element instanceof ZLTextImageElement)) {
      ZLTextElementArea area=myTextElementMap.get(index++);
      if (area.ChangeStyle) {
        setTextStyle(area.Style);
      }
      final int x=area.XStart;
      final int y=area.YEnd - getElementDescent(element) - myTextStyle.verticalShift();
      context.moveXTo(x);
      if (element instanceof ZLTextWord) {
        drawWord(x,y,(ZLTextWord)element,charNumber,-1,false);
      }
 else {
        context.drawImage(x,y,((ZLTextImageElement)element).getImage());
      }
    }
  }
  if (index != to) {
    ZLTextElementArea area=myTextElementMap.get(index++);
    if (area.ChangeStyle) {
      setTextStyle(area.Style);
    }
    int len=info.End.getCharNumber();
    final ZLTextWord word=(ZLTextWord)info.End.getElement();
    final int x=area.XStart;
    final int y=area.YEnd - getElementDescent(word) - myTextStyle.verticalShift();
    drawWord(x,y,word,0,len,area.AddHyphenationSign);
  }
  context.moveY(info.Descent + info.VSpaceAfter);
}

{
  myStyle.setStyle(info.StartStyle);
  final int y=Math.min(getContext().getY() + info.Height,topMargin() + myStyle.getTextAreaHeight());
  int spaceCounter=info.SpaceCounter;
  int fullCorrection=0;
  final boolean endOfParagraph=info.End.isEndOfParagraph();
  boolean wordOccurred=false;
  boolean changeStyle=true;
  getContext().moveXTo(leftMargin() + info.LeftIndent);
  final int maxWidth=getContext().getWidth() - leftMargin() - rightMargin();
switch (myStyle.getTextStyle().alignment()) {
case ZLTextAlignmentType.ALIGN_RIGHT:
{
      getContext().moveX(maxWidth - myStyle.getTextStyle().rightIndent() - info.Width);
      break;
    }
case ZLTextAlignmentType.ALIGN_CENTER:
{
    getContext().moveX((maxWidth - myStyle.getTextStyle().rightIndent() - info.Width) / 2);
    break;
  }
case ZLTextAlignmentType.ALIGN_JUSTIFY:
{
  if (!endOfParagraph && !(info.End.getElement() == ZLTextElement.AfterParagraph)) {
    fullCorrection=maxWidth - myStyle.getTextStyle().rightIndent() - info.Width;
  }
  break;
}
case ZLTextAlignmentType.ALIGN_LEFT:
case ZLTextAlignmentType.ALIGN_UNDEFINED:
{
break;
}
}
final ZLTextParagraphCursor paragraph=info.RealStart.getParagraphCursor();
int paragraphNumber=paragraph.getIndex();
final ZLTextWordCursor end=info.End;
for (myIteratorCursor.setCursor(info.RealStart); !myIteratorCursor.equalWordNumber(end); myIteratorCursor.nextWord()) {
final ZLTextElement element=paragraph.getElement(myIteratorCursor.getWordNumber());
final int x=getContext().getX();
final int width=myStyle.getElementWidth(element,myIteratorCursor.getCharNumber());
if (element == ZLTextElement.HSpace) {
if (wordOccurred && (spaceCounter > 0)) {
int correction=fullCorrection / spaceCounter;
getContext().moveX(getContext().getSpaceWidth() + correction);
fullCorrection-=correction;
wordOccurred=false;
--spaceCounter;
}
}
 else if ((element instanceof ZLTextWord) || (element instanceof ZLTextImageElement)) {
final int height=myStyle.getElementHeight(element);
final int descent=myStyle.getElementDescent(element);
final int length=(element instanceof ZLTextWord) ? ((ZLTextWord)element).Length : 0;
myTextElementMap.add(new ZLTextElementArea(paragraphNumber,myIteratorCursor.getWordNumber(),myIteratorCursor.getCharNumber(),length,false,changeStyle,myStyle.getTextStyle(),element,x,x + width - 1,y - height + 1,y + descent));
changeStyle=false;
wordOccurred=true;
}
 else if (element instanceof ZLTextControlElement) {
myStyle.applyControl((ZLTextControlElement)element);
changeStyle=true;
}
getContext().moveX(width);
}
getContext().moveY(info.Height + info.Descent + info.VSpaceAfter);
}

{
  ZLTextElementArea area=getElementByCoordinates(x,y);
  if (area != null) {
    ZLTextElement element=area.Element;
    if ((element instanceof ZLTextImageElement) || (element instanceof ZLTextWord)) {
      final ZLTextWordCursor cursor=new ZLTextWordCursor(StartCursor);
      cursor.moveToParagraph(area.ParagraphIndex);
      cursor.moveToParagraphStart();
      final int elementIndex=area.TextElementIndex;
      byte hyperlinkKind=FBTextKind.REGULAR;
      String id=null;
      for (int i=0; i < elementIndex; ++i) {
        ZLTextElement e=cursor.getElement();
        if (e instanceof ZLTextControlElement) {
          if (e instanceof ZLTextHyperlinkControlElement) {
            final ZLTextHyperlinkControlElement control=(ZLTextHyperlinkControlElement)e;
            hyperlinkKind=control.Kind;
            id=control.Label;
          }
 else {
            final ZLTextControlElement control=(ZLTextControlElement)e;
            if (!control.IsStart && (control.Kind == hyperlinkKind)) {
              hyperlinkKind=FBTextKind.REGULAR;
              id=null;
            }
          }
        }
        cursor.nextWord();
      }
      if (id != null) {
switch (hyperlinkKind) {
case FBTextKind.EXTERNAL_HYPERLINK:
          if (OpenInBrowserOption.getValue()) {
            ZLibrary.getInstance().openInBrowser(id);
          }
        return true;
case FBTextKind.FOOTNOTE:
case FBTextKind.INTERNAL_HYPERLINK:
      ((FBReader)Application).tryOpenFootnote(id);
    return true;
}
}
}
}
return false;
}

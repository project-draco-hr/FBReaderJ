{
  if (!myTOCStack.isEmpty()) {
    ContentsModel contentsModel=myBookModel.getContentsModel();
    if (!myContentsBuffer.isEmpty()) {
      contentsModel.addText(myContentsBuffer);
      myContentsBuffer.clear();
      myLastTOCParagraphIsEmpty=false;
    }
    if (myLastTOCParagraphIsEmpty) {
      contentsModel.addText(PERIOD);
      myLastTOCParagraphIsEmpty=false;
    }
    myTOCStack.remove(myTOCStack.size() - 1);
  }
  myContentsParagraphExists=false;
}

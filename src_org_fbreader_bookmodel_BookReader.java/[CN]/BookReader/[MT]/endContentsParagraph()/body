{
  final ArrayList<ZLTextTreeParagraph> tocStack=myTOCStack;
  if (!tocStack.isEmpty()) {
    ContentsModel contentsModel=myBookModel.getContentsModel();
    final ZLTextBuffer contentsBuffer=myContentsBuffer;
    if (!contentsBuffer.isEmpty()) {
      contentsModel.addText(contentsBuffer);
      contentsBuffer.clear();
      myLastTOCParagraphIsEmpty=false;
    }
 else     if (myLastTOCParagraphIsEmpty) {
      contentsModel.addText(PERIOD);
      myLastTOCParagraphIsEmpty=false;
    }
    tocStack.remove(tocStack.size() - 1);
  }
  myContentsParagraphExists=false;
}

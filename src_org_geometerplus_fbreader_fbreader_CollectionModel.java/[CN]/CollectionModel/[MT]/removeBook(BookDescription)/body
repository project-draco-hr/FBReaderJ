{
  final ArrayList indices=(ArrayList)paragraphIndicesByBook(book);
  if (indices == null) {
    return;
  }
  myBookToParagraph.remove(book);
  final int len=indices.size();
  for (int i=len - 1; i >= 0; --i) {
    int index=((Integer)indices.get(i)).intValue();
    ZLTextTreeParagraph paragraph=getTreeParagraph(index);
    int count=1;
    for (ZLTextTreeParagraph parent=paragraph.getParent(); (parent != null) && (parent.childNumber() == 1); parent=parent.getParent()) {
      ++count;
    }
    if (count > index) {
      count=index;
    }
    for (Iterator it=myBookToParagraph.entrySet().iterator(); it.hasNext(); ) {
      final Map.Entry entry=(Map.Entry)it.next();
      final ArrayList list=(ArrayList)entry.getValue();
      final int listLen=list.size();
      for (int j=0; j < listLen; ++j) {
        final int v=((Integer)list.get(j)).intValue();
        if (v >= index) {
          list.set(i,v - count);
        }
      }
    }
    for (; count > 0; --count) {
      removeParagraph(index--);
    }
  }
}

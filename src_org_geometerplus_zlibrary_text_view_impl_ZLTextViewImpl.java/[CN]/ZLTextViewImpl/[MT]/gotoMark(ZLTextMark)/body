{
  if (mark.ParagraphIndex < 0) {
    return;
  }
  boolean doRepaint=false;
  if (StartCursor.isNull()) {
    doRepaint=true;
    preparePaintInfo();
  }
  if (StartCursor.isNull()) {
    return;
  }
  final Position position=new Position(StartCursor);
  if ((StartCursor.getParagraphCursor().Index != mark.ParagraphIndex) || (StartCursor.getPosition().compareTo(mark) > 0)) {
    doRepaint=true;
    gotoParagraph(mark.ParagraphIndex,false);
    preparePaintInfo();
  }
  if (EndCursor.isNull()) {
    preparePaintInfo();
  }
  while (mark.compareTo(EndCursor.getPosition()) > 0) {
    doRepaint=true;
    scrollPage(true,ScrollingMode.NO_OVERLAPPING,0);
    preparePaintInfo();
  }
  if (doRepaint) {
    if (StartCursor.isNull()) {
      preparePaintInfo();
    }
    savePosition(position,StartCursor);
    Application.refreshWindow();
  }
}

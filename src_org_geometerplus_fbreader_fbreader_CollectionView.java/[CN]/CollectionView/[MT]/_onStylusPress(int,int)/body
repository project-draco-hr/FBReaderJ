{
  ZLTextElementArea imageArea=getElementByCoordinates(x,y);
  if ((imageArea != null) && (imageArea.Element instanceof ZLTextImageElement)) {
    ZLTextWordCursor cursor=new ZLTextWordCursor(getStartCursor());
    cursor.moveToParagraph(imageArea.ParagraphNumber);
    cursor.moveTo(imageArea.TextElementNumber,0);
    final ZLTextElement element=cursor.getElement();
    if (!(element instanceof ZLTextImageElement)) {
      return false;
    }
    final ZLTextImageElement imageElement=(ZLTextImageElement)element;
    final BookDescription book=collectionModel().bookByParagraphNumber(imageArea.ParagraphNumber);
    if (book == null) {
      return false;
    }
    final String imageId=imageElement.Id;
    if (imageId == CollectionModel.BookInfoImageId) {
      Runnable action=new Runnable(){
        public void run(){
          Collection.rebuild(false);
          myUpdateModel=true;
          selectBook(book);
          Application.refreshWindow();
        }
      }
;
      new BookInfoDialog(Collection,book.FileName,action).getDialog().run();
      return true;
    }
 else     if (imageId == CollectionModel.RemoveBookImageId) {
      String boxKey="removeBookBox";
      final String message;
{
        final String format=ZLDialogManager.getDialogMessage(boxKey);
        int index=format.indexOf("%s");
        if (index == -1) {
          message=format;
        }
 else {
          message=format.substring(0,index) + book.getTitle() + format.substring(index + 2);
        }
      }
      Runnable okAction=new Runnable(){
        public void run(){
          CollectionModel cModel=collectionModel();
          new BookList().removeFileName(book.FileName);
          cModel.removeBook(book);
          if (cModel.getParagraphsNumber() == 0) {
            gotoParagraph(0,false);
          }
 else {
            int index=getStartCursor().getParagraphCursor().getIndex();
            if (index >= cModel.getParagraphsNumber()) {
              index=cModel.getParagraphsNumber() - 1;
            }
            while (!cModel.getTreeParagraph(index).getParent().isOpen()) {
              --index;
            }
            gotoParagraph(index,false);
          }
          rebuildPaintInfo(true);
          Application.refreshWindow();
        }
      }
;
      ZLDialogManager.getInstance().showQuestionBox(boxKey,message,ZLDialogManager.YES_BUTTON,okAction,ZLDialogManager.NO_BUTTON,null,null,null);
      return true;
    }
    return false;
  }
  int index=getParagraphIndexByCoordinate(y);
  if (index == -1) {
    return false;
  }
  final BookDescription book=collectionModel().bookByParagraphNumber(index);
  if (book != null) {
    final FBReader fbreader=(FBReader)Application;
    fbreader.openBook(book);
    fbreader.showBookTextView();
    return true;
  }
  return false;
}

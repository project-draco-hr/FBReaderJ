{
  final String tag=getCollectionModel().getTagByParagraphIndex(paragraphIndex);
  if (tag == null) {
    return;
  }
  final String boxKey="removeTagBox";
  final String message;
{
    final String format=ZLDialogManager.getDialogMessage(boxKey);
    int index=format.indexOf("%s");
    if (index == -1) {
      message=format;
    }
 else {
      message=format.substring(0,index) + tag + format.substring(index + 2);
    }
  }
  final Runnable removeThisTagOnlyAction=new Runnable(){
    public void run(){
      getCollectionModel().removeAllMarks();
      Collection.removeTag(tag,false);
      updateModel();
      ZLApplication.Instance().refreshWindow();
    }
  }
;
  final Runnable removeSubTree=new Runnable(){
    public void run(){
      getCollectionModel().removeAllMarks();
      Collection.removeTag(tag,true);
      updateModel();
      ZLApplication.Instance().refreshWindow();
    }
  }
;
  if (Collection.hasSubtags(tag)) {
    if (Collection.hasBooks(tag)) {
      ZLDialogManager.getInstance().showQuestionBox(boxKey,message,"thisOnly",removeThisTagOnlyAction,"withSubtags",removeSubTree,ZLDialogManager.CANCEL_BUTTON,null);
    }
 else {
      ZLDialogManager.getInstance().showQuestionBox(boxKey,message,"withSubtags",removeSubTree,ZLDialogManager.CANCEL_BUTTON,null,null,null);
    }
  }
 else {
    ZLDialogManager.getInstance().showQuestionBox(boxKey,message,ZLDialogManager.YES_BUTTON,removeSubTree,ZLDialogManager.CANCEL_BUTTON,null,null,null);
  }
}

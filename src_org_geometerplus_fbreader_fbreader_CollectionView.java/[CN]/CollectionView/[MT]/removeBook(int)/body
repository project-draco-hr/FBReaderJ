{
  final CollectionModel cModel=getCollectionModel();
  final BookDescription book=cModel.getBookByParagraphIndex(paragraphIndex);
  if (book == null) {
    return;
  }
  String boxKey="removeBookBox";
  final String message;
{
    final String format=ZLDialogManager.getDialogMessage(boxKey);
    int index=format.indexOf("%s");
    if (index == -1) {
      message=format;
    }
 else {
      message=format.substring(0,index) + book.getTitle() + format.substring(index + 2);
    }
  }
  Runnable okAction=new Runnable(){
    public void run(){
      cModel.removeAllMarks();
      new BookList().removeFileName(book.FileName);
      cModel.removeBook(book);
      if (cModel.getParagraphsNumber() == 0) {
        gotoParagraph(0,false);
      }
 else {
        int index=StartCursor.getParagraphCursor().Index;
        if (index >= cModel.getParagraphsNumber()) {
          index=cModel.getParagraphsNumber() - 1;
        }
        while (!cModel.getTreeParagraph(index).getParent().isOpen()) {
          --index;
        }
        gotoParagraph(index,false);
      }
      rebuildPaintInfo(true);
      Application.refreshWindow();
    }
  }
;
  ZLDialogManager.getInstance().showQuestionBox(boxKey,message,ZLDialogManager.YES_BUTTON,okAction,ZLDialogManager.NO_BUTTON,null,null,null);
}

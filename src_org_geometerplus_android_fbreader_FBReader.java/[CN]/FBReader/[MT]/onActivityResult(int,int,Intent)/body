{
switch (requestCode) {
case REQUEST_PREFERENCES:
    if (resultCode != RESULT_DO_NOTHING) {
      final Book book=BookInfoActivity.bookByIntent(data);
      if (book != null) {
        getCollection().bindToService(this,new Runnable(){
          public void run(){
            onPreferencesUpdate(book);
          }
        }
);
      }
    }
  break;
case REQUEST_CANCEL_MENU:
try {
  final CancelMenuHelper.ActionType type=CancelMenuHelper.ActionType.valueOf(data.getStringExtra(CancelActivity.TYPE_KEY));
  Bookmark bookmark=null;
  if (type == CancelMenuHelper.ActionType.returnTo) {
    bookmark=SerializerUtil.deserializeBookmark(data.getStringExtra(CancelActivity.BOOKMARK_KEY));
  }
  myFBReaderApp.runCancelAction(type,bookmark);
}
 catch (Throwable t) {
}
break;
}
}

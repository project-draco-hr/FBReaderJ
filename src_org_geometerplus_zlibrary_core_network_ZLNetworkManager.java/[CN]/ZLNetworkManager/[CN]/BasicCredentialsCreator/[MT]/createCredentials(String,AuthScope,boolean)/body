{
  if (!"basic".equalsIgnoreCase(scope.getScheme()) && !"digest".equalsIgnoreCase(scope.getScheme())) {
    return null;
  }
  if (CredMap.containsKey(scope) || quietMode) {
    return CredMap.get(scope);
  }
  final String host=scope.getHost();
  final String area=scope.getRealm();
  final ZLStringOption usernameOption=new ZLStringOption("username",host + ":" + area,"");
  startAuthenticationDialog(host,area,scheme,usernameOption.getValue());
synchronized (this) {
    try {
      wait();
    }
 catch (    InterruptedException e) {
    }
  }
  Credentials creds=null;
  if (myUsername != null && myPassword != null) {
    usernameOption.setValue(myUsername);
    creds=new UsernamePasswordCredentials(myUsername,myPassword);
    CredMap.put(scope,creds);
  }
  myUsername=null;
  myPassword=null;
  return creds;
}

{
  View v=convertView;
  final Item item=getItem(position);
  if (item instanceof SectionItem) {
    v=LayoutInflater.from(getContext()).inflate(R.layout.checkbox_section,null);
    TextView tt=(TextView)v.findViewById(R.id.title);
    if (tt != null) {
      tt.setText(((SectionItem)item).Title);
    }
  }
 else {
    final CatalogItem catalogItem=(CatalogItem)item;
    if (myCoverManager == null) {
      v.measure(ViewGroup.LayoutParams.FILL_PARENT,ViewGroup.LayoutParams.WRAP_CONTENT);
      final int coverHeight=v.getMeasuredHeight();
      myCoverManager=new CoverManager(AllCatalogsActivity.this,coverHeight * 15 / 12,coverHeight);
      v.requestLayout();
    }
    v=LayoutInflater.from(getContext()).inflate(R.layout.checkbox_item,null);
    final INetworkLink link=catalogItem.Tree.getLink();
    ((TextView)v.findViewById(R.id.title)).setText(link.getTitle());
    ((TextView)v.findViewById(R.id.subtitle)).setText(link.getSummary());
    final ImageView coverView=(ImageView)v.findViewById(R.id.icon);
    if (!myCoverManager.trySetCoverImage(coverView,catalogItem.Tree)) {
      coverView.setImageResource(R.drawable.ic_list_library_books);
    }
    final CheckBox checkBox=(CheckBox)v.findViewById(R.id.check_item);
    checkBox.setChecked(catalogItem.IsChecked);
    checkBox.setOnClickListener(new View.OnClickListener(){
      public void onClick(      View v){
        catalogItem.IsChecked=checkBox.isChecked();
        myIsChanged=true;
      }
    }
);
  }
  return v;
}

{
  final Intent intent=new Intent(Intent.ACTION_VIEW);
  final boolean externalUrl;
  if (BookDownloader.acceptsUri(Uri.parse(url))) {
    intent.setClass(BaseActivity,BookDownloader.class);
    intent.putExtra(BookDownloaderService.SHOW_NOTIFICATIONS_KEY,BookDownloaderService.Notifications.ALL);
    externalUrl=false;
  }
 else {
    externalUrl=true;
  }
  final NetworkLibrary nLibrary=NetworkLibrary.Instance();
  new Thread(new Runnable(){
    public void run(){
      if (!url.startsWith("fbreader-action:")) {
        nLibrary.initialize();
      }
      intent.setData(Uri.parse(nLibrary.rewriteUrl(url,externalUrl)));
      BaseActivity.runOnUiThread(new Runnable(){
        public void run(){
          try {
            BaseActivity.startActivity(intent);
          }
 catch (          ActivityNotFoundException e) {
            e.printStackTrace();
          }
        }
      }
);
    }
  }
).start();
}

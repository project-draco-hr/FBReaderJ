{
  while (myBufferOffset == myBufferLength) {
    if (myRecordIndex + 1 > myMaxRecordIndex) {
      return false;
    }
    ++myRecordIndex;
    final int currentOffset=myHeader.Offsets[myRecordIndex];
    try {
      myBase.skip(currentOffset - myBase.offset());
      final int nextOffset=(myRecordIndex + 1 < myHeader.Offsets.length) ? myHeader.Offsets[myRecordIndex + 1] : (int)myFileSize;
      if (nextOffset < currentOffset) {
        return false;
      }
      final short recordSize=(short)(nextOffset - currentOffset);
switch (myCompressionType) {
case CompressionType.NONE:
        myBase.read(myBuffer,0,recordSize);
      myBufferLength=recordSize;
    break;
case CompressionType.DOC:
  myBufferLength=(short)DocDecompressor.decompress(myBase,myBuffer,recordSize);
break;
default :
return false;
}
}
 catch (IOException e) {
return false;
}
myBufferOffset=0;
}
return true;
}

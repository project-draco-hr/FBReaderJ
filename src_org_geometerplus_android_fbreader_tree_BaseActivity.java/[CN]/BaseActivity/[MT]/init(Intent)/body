{
  final FBTree.Key key=(FBTree.Key)intent.getSerializableExtra(TREE_KEY_KEY);
  final FBTree.Key selectedKey=(FBTree.Key)intent.getSerializableExtra(SELECTED_TREE_KEY_KEY);
  myCurrentTree=getTreeByKey(key);
  myCurrentKey=myCurrentTree.getUniqueKey();
  final ListAdapter adapter=getListAdapter();
  adapter.replaceAll(myCurrentTree.subTrees());
  setTitle(myCurrentTree.getTreeTitle());
  final FBTree selectedTree=selectedKey != null ? getTreeByKey(selectedKey) : adapter.getFirstSelectedItem();
  setSelection(adapter.getIndex(selectedTree));
  myHistory=(ArrayList<FBTree.Key>)intent.getSerializableExtra(HISTORY_KEY);
  if (myHistory == null) {
    myHistory=new ArrayList<FBTree.Key>();
  }
  onCurrentTreeChanged();
}

{
  Cursor cursor=myDatabase.rawQuery("SELECT book_id,file_name,title,encoding,language FROM Books",null);
  final int count=cursor.getCount();
  final HashMap<Long,BookDescription> booksById=new HashMap<Long,BookDescription>(count);
  final HashMap<String,BookDescription> booksByFilename=new HashMap<String,BookDescription>(count);
  while (cursor.moveToNext()) {
    final long id=cursor.getLong(0);
    final String fileName=cursor.getString(1);
    final BookDescription description=createDescription(id,fileName,cursor.getString(2),cursor.getString(3),cursor.getString(4));
    booksById.put(id,description);
    booksByFilename.put(fileName,description);
  }
  cursor.close();
  initCaches();
  cursor=myDatabase.rawQuery("SELECT book_id,author_id FROM BookAuthor ORDER BY author_index",null);
  while (cursor.moveToNext()) {
    BookDescription book=booksById.get(cursor.getLong(0));
    if (book != null) {
      Author author=myAuthorById.get(cursor.getLong(1));
      if (author != null) {
        addAuthor(book,author);
      }
    }
  }
  cursor.close();
  cursor=myDatabase.rawQuery("SELECT book_id,tag_id FROM BookTag",null);
  while (cursor.moveToNext()) {
    BookDescription book=booksById.get(cursor.getLong(0));
    if (book != null) {
      addTag(book,getTagById(cursor.getLong(1)));
    }
  }
  cursor.close();
  cursor=myDatabase.rawQuery("SELECT book_id,series_id,book_index FROM BookSeries",null);
  while (cursor.moveToNext()) {
    BookDescription book=booksById.get(cursor.getLong(0));
    if (book != null) {
      String series=mySeriesById.get(cursor.getLong(1));
      if (series != null) {
        setSeriesInfo(book,series,cursor.getLong(2));
      }
    }
  }
  cursor.close();
  return booksByFilename;
}

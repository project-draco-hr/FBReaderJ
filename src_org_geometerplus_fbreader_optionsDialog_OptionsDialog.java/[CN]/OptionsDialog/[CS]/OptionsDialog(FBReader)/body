{
  final ZLTextBaseStyle baseStyle=ZLTextStyleCollection.getInstance().baseStyle();
  myDialog=ZLDialogManager.getInstance().createOptionsDialog("OptionsDialog",null,new OptionsApplyRunnable(fbreader),true);
  final ZLDialogContent libraryTab=myDialog.createTab("Library");
  final CollectionView collectionView=fbreader.CollectionView;
  final BookCollection collection=collectionView.Collection;
  libraryTab.addOption("bookPath",collection.PathOption);
  libraryTab.addOption("lookInSubdirectories",collection.ScanSubdirsOption);
  libraryTab.addOption("recentListSize",new ZLSimpleSpinOptionEntry(fbreader.RecentBooksView.lastBooks().MaxListSizeOption,1));
  ZLToggleBooleanOptionEntry showTagsEntry=new ZLToggleBooleanOptionEntry(collectionView.ShowTagsOption);
  ZLOptionEntry showAllBooksTagEntry=new ZLSimpleBooleanOptionEntry(collectionView.ShowAllBooksTagOption);
  showTagsEntry.addDependentEntry(showAllBooksTagEntry);
  libraryTab.addOption("showTags",showTagsEntry);
  libraryTab.addOption("showAllBooksList",showAllBooksTagEntry);
  showTagsEntry.onStateChanged(showTagsEntry.initialState());
  final ZLDialogContent encodingTab=myDialog.createTab("Language");
  encodingTab.addOption("autoDetect",new ZLSimpleBooleanOptionEntry(PluginCollection.instance().LanguageAutoDetectOption));
  encodingTab.addOption("defaultLanguage",new ZLLanguageOptionEntry(PluginCollection.instance().DefaultLanguageOption,ZLLanguageList.languageCodes()));
  encodingTab.addOption("useWindows1252Hack",new ZLSimpleBooleanOptionEntry(ZLEncodingCollection.useWindows1252HackOption()));
  new ScrollingOptionsPage(myDialog.createTab("Scrolling"),fbreader);
  final ZLDialogContent selectionTab=myDialog.createTab("Selection");
  selectionTab.addOption("enableSelection",FBView.selectionOption());
  ZLDialogContent marginTab=myDialog.createTab("Margins");
  marginTab.addOptions("left",new ZLSimpleSpinOptionEntry(FBView.getLeftMarginOption(),1),"right",new ZLSimpleSpinOptionEntry(FBView.getRightMarginOption(),1));
  marginTab.addOptions("top",new ZLSimpleSpinOptionEntry(FBView.getTopMarginOption(),1),"bottom",new ZLSimpleSpinOptionEntry(FBView.getBottomMarginOption(),1));
  new FormatOptionsPage(myDialog.createTab("Format"));
  new StyleOptionsPage(myDialog.createTab("Styles"),fbreader.Context);
  createIndicatorTab(fbreader);
  final ZLDialogContent rotationTab=myDialog.createTab("Rotation");
  rotationTab.addOption("direction",new RotationTypeEntry(rotationTab.getResource("direction"),fbreader.RotationAngleOption));
  final ZLDialogContent colorsTab=myDialog.createTab("Colors");
  final String colorKey="colorFor";
  final ZLResource resource=colorsTab.getResource(colorKey);
  final ZLColorOptionBuilder builder=new ZLColorOptionBuilder();
  final String BACKGROUND=resource.getResource("background").getValue();
  builder.addOption(BACKGROUND,baseStyle.BackgroundColorOption);
  builder.addOption(resource.getResource("text").getValue(),baseStyle.RegularTextColorOption);
  builder.addOption(resource.getResource("internalLink").getValue(),baseStyle.InternalHyperlinkTextColorOption);
  builder.addOption(resource.getResource("externalLink").getValue(),baseStyle.ExternalHyperlinkTextColorOption);
  builder.addOption(resource.getResource("highlighted").getValue(),baseStyle.HighlightedTextColorOption);
  builder.addOption(resource.getResource("treeLines").getValue(),baseStyle.TreeLinesColorOption);
  builder.addOption(resource.getResource("indicator").getValue(),FBView.getIndicatorInfoStatic().ColorOption);
  builder.setInitial(BACKGROUND);
  colorsTab.addOption(colorKey,builder.comboEntry());
  colorsTab.addOption("",builder.colorEntry());
  new KeyBindingsPage(fbreader,myDialog.createTab("Keys"));
  final ZLDialogContent webTab=myDialog.createTab("Web");
  webTab.addOption("defaultText",new ZLToggleBooleanOptionEntry(fbreader.BookTextView.OpenInBrowserOption));
}

{
  if (item != null && item instanceof CatalogItem) {
    CatalogItem catalogItem=(CatalogItem)item;
    if (catalogItem.IsChecked) {
      int insertIndex=index <= 0 ? -1 : (index - 1);
      if (mySelectedItems.contains(catalogItem)) {
        mySelectedItems.remove(catalogItem);
      }
      if (insertIndex >= 0) {
        mySelectedItems.add(insertIndex,catalogItem);
      }
 else {
        mySelectedItems.add(catalogItem);
      }
    }
 else {
      mySelectedItems.remove(catalogItem);
    }
    final ArrayList<String> ids=new ArrayList<String>();
    for (    Item selectedItem : mySelectedItems) {
      if (selectedItem instanceof CatalogItem) {
        final CatalogItem ci=(CatalogItem)selectedItem;
        if (ci.IsChecked) {
          ids.add(ci.Id);
        }
      }
    }
    setResult(RESULT_OK,new Intent().putStringArrayListExtra(FBReader.CATALOGS_ID_LIST,ids));
  }
}

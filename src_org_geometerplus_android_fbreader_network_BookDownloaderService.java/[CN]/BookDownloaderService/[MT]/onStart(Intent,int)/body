{
  super.onStart(intent,startId);
  myStartIds.offer(startId);
  final Uri uri=intent.getData();
  if (uri == null) {
    stopSelf(myStartIds.poll().intValue());
    return;
  }
  intent.setData(null);
  String fileName=BookReference.makeBookFileName(uri.toString(),BookReference.Format.NONE,BookReference.Type.UNKNOWN);
  if (fileName == null) {
    stopSelf(myStartIds.poll().intValue());
    return;
  }
  int index=fileName.lastIndexOf(File.separator);
  if (index != -1) {
    final String dir=fileName.substring(0,index);
    final File dirFile=new File(dir);
    if (!dirFile.mkdirs() || !dirFile.isDirectory()) {
      stopSelf(myStartIds.poll().intValue());
      return;
    }
  }
  final File fileFile=new File(fileName);
  if (fileFile.exists()) {
    if (!fileFile.isFile()) {
      stopSelf(myStartIds.poll().intValue());
      return;
    }
    stopSelf(myStartIds.poll().intValue());
    startActivity(getFBReaderIntent(fileFile));
    return;
  }
  startFileDownload(uri.toString(),fileFile);
}

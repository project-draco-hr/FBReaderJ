{
  super.onCreate(icicle);
  Thread.setDefaultUncaughtExceptionHandler(new org.geometerplus.zlibrary.ui.android.library.UncaughtExceptionHandler(this));
  final Intent intent=getIntent();
  if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
    final String pattern=intent.getStringExtra(SearchManager.QUERY);
    final Handler successHandler=new Handler(){
      public void handleMessage(      Message message){
        onSuccess();
      }
    }
;
    final Handler failureHandler=new Handler(){
      public void handleMessage(      Message message){
        Toast.makeText(getParentActivity(),ZLResource.resource("errorMessage").getResource(getFailureMessageResourceKey()).getValue(),Toast.LENGTH_SHORT).show();
      }
    }
;
    ZLDialogManager.Instance().wait(getWaitMessageResourceKey(),new Runnable(){
      public void run(){
        if (runSearch(pattern)) {
          successHandler.sendEmptyMessage(0);
        }
 else {
          failureHandler.sendEmptyMessage(0);
        }
      }
    }
);
  }
  finish();
}

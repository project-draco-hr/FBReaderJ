{
  String text=region.Word.toString();
  int start=0;
  int end=text.length();
  for (; start < end && !Character.isLetterOrDigit(text.charAt(start)); ++start)   ;
  for (; start < end && !Character.isLetterOrDigit(text.charAt(end - 1)); --end)   ;
  if (start == end) {
    return;
  }
  final PackageInfo info=getCurrentDictionaryInfo();
  final Intent intent=getDictionaryIntent(info,text.substring(start,end));
  try {
    if ("ColorDict".equals(info.Id)) {
      final DisplayMetrics metrics=new DisplayMetrics();
      activity.getWindowManager().getDefaultDisplay().getMetrics(metrics);
      final int screenHeight=metrics.heightPixels;
      final int topSpace=region.getTop();
      final int bottomSpace=metrics.heightPixels - region.getBottom();
      final boolean showAtBottom=bottomSpace >= topSpace;
      final int space=(showAtBottom ? bottomSpace : topSpace) - 20;
      final int maxHeight=Math.min(400,screenHeight * 2 / 3);
      final int minHeight=Math.min(200,screenHeight * 2 / 3);
      intent.putExtra(ColorDict3.HEIGHT,Math.max(minHeight,Math.min(maxHeight,space)));
      intent.putExtra(ColorDict3.GRAVITY,showAtBottom ? Gravity.BOTTOM : Gravity.TOP);
      final ZLAndroidApplication application=ZLAndroidApplication.Instance();
      intent.putExtra(ColorDict3.FULLSCREEN,!application.ShowStatusBarOption.getValue());
    }
    activity.startActivity(intent);
  }
 catch (  ActivityNotFoundException e) {
    DictionaryUtil.installDictionaryIfNotInstalled(activity);
  }
}

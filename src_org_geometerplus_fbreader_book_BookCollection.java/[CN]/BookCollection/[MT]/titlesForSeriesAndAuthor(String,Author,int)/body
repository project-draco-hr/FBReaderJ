{
  if (limit <= 0) {
    return Collections.emptyList();
  }
  final boolean isNull=Author.NULL.equals(author);
  final ArrayList<String> titles=new ArrayList<String>(limit);
synchronized (myBooksByFile) {
    for (    Book b : myBooksByFile.values()) {
      final List<Author> bookAuthors=b.authors();
      final SeriesInfo info=b.getSeriesInfo();
      if (info != null && series.equals(info.Title) && (isNull && bookAuthors.isEmpty() || bookAuthors.contains(author))) {
        titles.add(b.getTitle());
        if (--limit == 0) {
          break;
        }
      }
    }
  }
  return titles;
}

{
  if (limit <= 0) {
    return Collections.emptyList();
  }
  final ArrayList<String> titles=new ArrayList<String>(limit);
  final boolean isNull=Author.NULL.equals(author);
synchronized (myBooksByFile) {
    for (    Book b : myBooksByFile.values()) {
      if (isNull ? b.authors().isEmpty() : b.authors().contains(author)) {
        titles.add(b.getTitle());
        if (--limit == 0) {
          break;
        }
      }
    }
  }
  return titles;
}

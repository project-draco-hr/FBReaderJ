{
  AlertDialog alert=(AlertDialog)dialog;
  myLogin=((TextView)alert.findViewById(R.id.network_register_login)).getText().toString().trim();
  myPassword=((TextView)alert.findViewById(R.id.network_register_password)).getText().toString();
  final String confirmPassword=((TextView)alert.findViewById(R.id.network_register_confirm_password)).getText().toString();
  myEmail=((TextView)alert.findViewById(R.id.network_register_email)).getText().toString().trim();
  if (myLogin.length() == 0) {
    myLogin=null;
    final String err=NetworkErrors.errorMessage(NetworkErrors.ERROR_LOGIN_WAS_NOT_SPECIFIED);
    sendError(true,false,err);
    return;
  }
  if (!myPassword.equals(confirmPassword)) {
    final String err=myResource.getResource("differentPasswords").getValue();
    myPassword=null;
    sendError(true,false,err);
    return;
  }
  if (myEmail.length() == 0) {
    myEmail=null;
    final String err=NetworkErrors.errorMessage(NetworkErrors.ERROR_EMAIL_WAS_NOT_SPECIFIED);
    sendError(true,false,err);
    return;
  }
  final int atPos=myEmail.indexOf("@");
  if (atPos == -1 || myEmail.indexOf(".",atPos) == -1) {
    final String err=NetworkErrors.errorMessage(NetworkErrors.ERROR_INVALID_EMAIL);
    sendError(true,false,err);
    return;
  }
  final NetworkAuthenticationManager mgr=myLink.authenticationManager();
  final Runnable runnable=new Runnable(){
    public void run(){
      String err=mgr.registerUser(myLogin,myPassword,myEmail);
      if (err != null) {
        mgr.logOut();
        sendError(true,false,err);
        return;
      }
      if (mgr.isAuthorised(true).Status != ZLBoolean3.B3_FALSE && mgr.needsInitialization()) {
        err=mgr.initialize();
        if (err != null) {
          mgr.logOut();
          sendError(false,false,err);
          return;
        }
      }
      sendSuccess(false);
    }
  }
;
  ((ZLAndroidDialogManager)ZLAndroidDialogManager.Instance()).wait("registerUser",runnable,myActivity);
}

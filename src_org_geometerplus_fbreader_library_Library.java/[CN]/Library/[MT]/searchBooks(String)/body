{
  if (pattern == null) {
    fireModelChangedEvent(ChangeListener.Code.NotFound);
    return;
  }
  pattern=pattern.toLowerCase();
  final SearchResultsTree oldSearchResults=(SearchResultsTree)getFirstLevelTree(ROOT_FOUND);
  if (oldSearchResults != null && pattern.equals(oldSearchResults.getPattern())) {
    fireModelChangedEvent(ChangeListener.Code.Found);
    return;
  }
  FirstLevelTree newSearchResults=null;
  final List<Book> booksCopy;
synchronized (myBooks) {
    booksCopy=new ArrayList<Book>(myBooks);
  }
  for (  Book book : booksCopy) {
    if (book.matches(pattern)) {
synchronized (this) {
        if (newSearchResults == null) {
          if (oldSearchResults != null) {
            oldSearchResults.removeSelf();
          }
          newSearchResults=new SearchResultsTree(myRootTree,ROOT_FOUND,pattern);
          fireModelChangedEvent(ChangeListener.Code.Found);
        }
        newSearchResults.getBookSubTree(book,true);
        fireModelChangedEvent(ChangeListener.Code.BookAdded);
      }
    }
  }
  if (newSearchResults == null) {
    fireModelChangedEvent(ChangeListener.Code.NotFound);
  }
}

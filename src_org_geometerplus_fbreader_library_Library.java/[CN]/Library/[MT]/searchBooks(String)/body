{
  if (pattern == null) {
    fireModelChangedEvent(ChangeListener.Code.NotFound);
    return;
  }
  pattern=pattern.toLowerCase();
  final SearchResultsTree oldSearchResults=(SearchResultsTree)getFirstLevelTree(LibraryTree.ROOT_FOUND);
  if (oldSearchResults != null && pattern.equals(oldSearchResults.getPattern())) {
    fireModelChangedEvent(ChangeListener.Code.Found);
    return;
  }
  FirstLevelTree newSearchResults=null;
synchronized (this) {
    for (    Book book : Collection.books(pattern)) {
      if (newSearchResults == null) {
        if (oldSearchResults != null) {
          oldSearchResults.removeSelf();
        }
        newSearchResults=new SearchResultsTree(myRootTree,LibraryTree.ROOT_FOUND,pattern);
        fireModelChangedEvent(ChangeListener.Code.Found);
      }
      newSearchResults.createBookWithAuthorsSubTree(book);
      fireModelChangedEvent(ChangeListener.Code.BookAdded);
    }
  }
  if (newSearchResults == null) {
    fireModelChangedEvent(ChangeListener.Code.NotFound);
  }
}

{
  Collection=collection;
  Collection.addListener(new BookCollection.Listener(){
    public void onBookEvent(    BookEvent event,    Book book){
switch (event) {
case Added:
        addBookToLibrary(book);
      if (Collection.size() % 16 == 0) {
        Library.this.fireModelChangedEvent(ChangeListener.Code.BookAdded);
      }
    break;
}
}
public void onBuildEvent(BuildEvent event){
switch (event) {
case Started:
  Library.this.fireModelChangedEvent(ChangeListener.Code.StatusChanged);
for (Book book : Collection.recentBooks()) {
  new BookTree(getFirstLevelTree(ROOT_RECENT),book,true);
}
for (Book book : Collection.favorites()) {
new BookTree(getFirstLevelTree(ROOT_FAVORITES),book,true);
}
setStatus(myStatusMask | STATUS_LOADING);
break;
case Completed:
Library.this.fireModelChangedEvent(ChangeListener.Code.BookAdded);
setStatus(myStatusMask & ~STATUS_LOADING);
break;
}
}
}
);
new FavoritesTree(myRootTree,ROOT_FAVORITES);
new FirstLevelTree(myRootTree,ROOT_RECENT);
new FirstLevelTree(myRootTree,ROOT_BY_AUTHOR);
new FirstLevelTree(myRootTree,ROOT_BY_TITLE);
new FirstLevelTree(myRootTree,ROOT_BY_TAG);
new FileFirstLevelTree(collection,myRootTree,ROOT_FILE_TREE);
}

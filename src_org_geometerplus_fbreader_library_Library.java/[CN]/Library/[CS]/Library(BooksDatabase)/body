{
  myDatabase=db;
  myCollection=new BookCollection(db);
  myCollection.addListener(new BookCollection.Listener(){
    public void onBookEvent(    BookEvent event,    Book book){
switch (event) {
case Added:
        addBookToLibrary(book);
      if (myCollection.size() % 16 == 0) {
        Library.this.fireModelChangedEvent(ChangeListener.Code.BookAdded);
      }
    break;
}
}
public void onBuildEvent(BuildEvent event){
switch (event) {
case Started:
  Library.this.fireModelChangedEvent(ChangeListener.Code.StatusChanged);
setStatus(myStatusMask | STATUS_LOADING);
break;
case Completed:
Library.this.fireModelChangedEvent(ChangeListener.Code.BookAdded);
setStatus(myStatusMask & ~STATUS_LOADING);
break;
}
}
}
);
new FavoritesTree(myRootTree,ROOT_FAVORITES);
new FirstLevelTree(myRootTree,ROOT_RECENT);
new FirstLevelTree(myRootTree,ROOT_BY_AUTHOR);
new FirstLevelTree(myRootTree,ROOT_BY_TITLE);
new FirstLevelTree(myRootTree,ROOT_BY_TAG);
new FileFirstLevelTree(myRootTree,ROOT_FILE_TREE);
}

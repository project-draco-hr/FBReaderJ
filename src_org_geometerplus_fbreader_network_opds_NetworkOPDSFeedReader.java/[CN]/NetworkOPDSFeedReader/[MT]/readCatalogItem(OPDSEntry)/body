{
  final OPDSNetworkLink opdsLink=(OPDSNetworkLink)myData.Link;
  String coverURL=null;
  String url=null;
  boolean urlIsAlternate=false;
  String htmlURL=null;
  boolean litresCatalogue=false;
  int catalogType=NetworkCatalogItem.CATALOG_OTHER;
  for (  ATOMLink link : entry.Links) {
    final String href=ZLNetworkUtil.url(myBaseURL,link.getHref());
    final String type=ZLNetworkUtil.filterMimeType(link.getType());
    final String rel=opdsLink.relation(link.getRel(),type);
    if (MIME_IMAGE_PNG.equals(type) || MIME_IMAGE_JPEG.equals(type)) {
      if (REL_IMAGE_THUMBNAIL.equals(rel) || REL_THUMBNAIL.equals(rel) || (coverURL == null && (REL_COVER.equals(rel) || (rel != null && rel.startsWith(REL_IMAGE_PREFIX))))) {
        coverURL=href;
      }
    }
 else     if (MIME_APP_ATOM.equals(type)) {
      if (ATOMConstants.REL_ALTERNATE.equals(rel)) {
        if (url == null) {
          url=href;
          urlIsAlternate=true;
        }
      }
 else       if (url == null || rel == null || rel.equals(REL_SUBSECTION)) {
        url=href;
        urlIsAlternate=false;
        if (REL_CATALOG_AUTHOR.equals(rel)) {
          catalogType=NetworkCatalogItem.CATALOG_BY_AUTHORS;
        }
      }
    }
 else     if (MIME_TEXT_HTML.equals(type)) {
      if (REL_ACQUISITION.equals(rel) || REL_ACQUISITION_OPEN.equals(rel) || ATOMConstants.REL_ALTERNATE.equals(rel)|| rel == null) {
        htmlURL=href;
      }
    }
 else     if (MIME_APP_LITRES.equals(type)) {
      if (REL_BOOKSHELF.equals(rel)) {
        litresCatalogue=true;
        url=href;
      }
    }
  }
  if (url == null && htmlURL == null) {
    return null;
  }
  if (url != null && !urlIsAlternate) {
    htmlURL=null;
  }
  final boolean dependsOnAccount=OPDSNetworkLink.FeedCondition.SIGNED_IN == opdsLink.getCondition(entry.Id.Uri);
  final String annotation;
  if (entry.Summary != null) {
    annotation=entry.Summary.replace("\n","");
  }
 else   if (entry.Content != null) {
    annotation=entry.Content.replace("\n","");
  }
 else {
    annotation=null;
  }
  HashMap<Integer,String> urlMap=new HashMap<Integer,String>();
  if (url != null) {
    urlMap.put(NetworkCatalogItem.URL_CATALOG,url);
  }
  if (htmlURL != null) {
    urlMap.put(NetworkCatalogItem.URL_HTML_PAGE,htmlURL);
  }
  if (litresCatalogue) {
    return new LitResBookshelfItem(opdsLink,entry.Title,annotation,coverURL,urlMap,dependsOnAccount ? NetworkCatalogItem.AccessibilityType.SIGNED_IN : NetworkCatalogItem.AccessibilityType.ALWAYS);
  }
 else {
    return new OPDSCatalogItem(opdsLink,entry.Title,annotation,coverURL,urlMap,dependsOnAccount ? NetworkCatalogItem.AccessibilityType.SIGNED_IN : NetworkCatalogItem.AccessibilityType.ALWAYS,catalogType);
  }
}

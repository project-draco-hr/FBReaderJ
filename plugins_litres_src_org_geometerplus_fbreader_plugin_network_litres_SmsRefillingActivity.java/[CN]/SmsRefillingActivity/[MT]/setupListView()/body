{
  final TelephonyManager manager=(TelephonyManager)getSystemService(Activity.TELEPHONY_SERVICE);
  if (manager == null) {
    setError(myResource.getResource("noPhoneInfo").getValue());
    return;
  }
  final String operator=manager.getNetworkOperator();
  if (operator == null || operator.length() <= 3) {
    setError(myResource.getResource("noCellularNetwork").getValue());
    return;
  }
  System.err.println(manager.getSimOperator());
  System.err.println(manager.getSimOperatorName());
  String url="http://data.fbreader.org/catalogs/litres/sms/smsinfo.php";
  url=ZLNetworkUtil.appendParameter(url,"mcc",operator.substring(0,3));
  url=ZLNetworkUtil.appendParameter(url,"mnc",operator.substring(3));
  url=ZLNetworkUtil.appendParameter(url,"name",manager.getNetworkOperatorName());
  url=ZLNetworkUtil.appendParameter(url,"lang",Locale.getDefault().getLanguage());
  try {
    ZLNetworkManager.Instance().perform(new ZLNetworkRequest(url){
      public void handleStream(      URLConnection connection,      InputStream inputStream) throws IOException, ZLNetworkException {
        final SmsInfoXMLReader reader=new SmsInfoXMLReader();
        reader.read(inputStream);
        if (reader.Infos.size() > 0) {
          ((ListView)findViewById(R.id.sms_list)).setAdapter(new SmsListAdapter(reader.Infos));
          findViewById(R.id.sms_error).setVisibility(View.GONE);
        }
 else {
          setError(reader.ErrorMessage);
        }
      }
    }
);
  }
 catch (  ZLNetworkException e) {
    setError(e.getMessage());
  }
}

{
  super.onCreate(icicle);
  Thread.setDefaultUncaughtExceptionHandler(new org.geometerplus.zlibrary.ui.android.library.UncaughtExceptionHandler(this));
  DatabaseInstance=SQLiteBooksDatabase.Instance();
  if (DatabaseInstance == null) {
    DatabaseInstance=new SQLiteBooksDatabase(this,"LIBRARY");
  }
  if (LibraryInstance == null) {
    LibraryInstance=new Library();
    startService(new Intent(getApplicationContext(),InitializationService.class));
  }
  final String treePathString=getIntent().getStringExtra(TREE_PATH_KEY);
  myTreePath=treePathString != null ? treePathString.split("\000") : new String[0];
  myTreeKey=(FBTree.Key)getIntent().getSerializableExtra(TREE_KEY_KEY);
  mySelectedBookPath=getIntent().getStringExtra(SELECTED_BOOK_PATH_KEY);
  mySelectedBook=null;
  if (mySelectedBookPath != null) {
    final ZLFile file=ZLFile.createFileByPath(mySelectedBookPath);
    if (file != null) {
      mySelectedBook=Book.getByFile(file);
    }
  }
  setResult(RESULT_DONT_INVALIDATE_VIEWS);
}

{
  Set<String> usedCategories=myConfig.applyDelta();
  Map<String,StringBuffer> configFilesContent=new LinkedHashMap<String,StringBuffer>();
  StringBuffer sb;
  Map<String,Boolean> currentGroupOpenedIn;
  for (  ZLGroup group : myConfig.groups()) {
    currentGroupOpenedIn=new HashMap<String,Boolean>();
    for (    ZLOptionInfo value : group.options()) {
      sb=configFilesContent.get(value.getCategory());
      if (currentGroupOpenedIn.get(value.getCategory()) == null) {
        currentGroupOpenedIn.put(value.getCategory(),false);
      }
      if (sb == null) {
        sb=new StringBuffer();
        configFilesContent.put(value.getCategory(),sb);
      }
      if (!currentGroupOpenedIn.get(value.getCategory())) {
        sb.append("  <group name=\"" + group.getName() + "\">\n");
        currentGroupOpenedIn.put(value.getCategory(),true);
      }
      sb.append(value);
    }
    for (    String category : currentGroupOpenedIn.keySet()) {
      configFilesContent.get(category).append("  </group>\n");
    }
  }
  for (  String category : usedCategories) {
    this.writeConfigFile("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<config>\n" + configFilesContent.get(category) + "</config>",configFilePath(category));
  }
  for (  String category : usedCategories) {
    if (!configFilesContent.keySet().contains(category)) {
      deleteConfigFile(configFilePath(category));
    }
  }
}

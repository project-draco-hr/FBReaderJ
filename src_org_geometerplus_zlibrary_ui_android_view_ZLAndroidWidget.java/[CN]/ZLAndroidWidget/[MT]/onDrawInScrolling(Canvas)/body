{
  final ZLView view=ZLApplication.Instance().getCurrentView();
  final int w=getWidth();
  final int h=getMainAreaHeight();
  final AnimationProvider animator=getAnimationProvider();
  final AnimationProvider.ScrollingMode mode=animator.getScrollingMode();
  if (mode.Auto) {
    doStep();
  }
  if (animator.inProgress()) {
    animator.setup(myStartX,myStartY,myEndX,myEndY,myScrollingDirection,getWidth(),getMainAreaHeight());
    animator.draw(canvas,mySecondaryBitmap,myMainBitmap);
    if (animator.getScrollingMode().Auto) {
      postInvalidate();
    }
    drawFooter(canvas);
  }
 else {
    if (mode == AnimationProvider.ScrollingMode.AutoScrollingForward) {
      Bitmap swap=myMainBitmap;
      myMainBitmap=mySecondaryBitmap;
      mySecondaryBitmap=swap;
      view.onScrollingFinished(myPageToScrollTo);
      ZLApplication.Instance().onRepaintFinished();
    }
 else {
      view.onScrollingFinished(ZLView.PageIndex.current);
    }
    setPageToScrollTo(ZLView.PageIndex.current);
    onDrawStatic(canvas);
  }
}

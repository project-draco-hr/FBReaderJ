{
  int x=(int)event.getX();
  int y=(int)event.getY();
  final ZLView view=ZLApplication.Instance().getCurrentView();
switch (event.getAction()) {
case MotionEvent.ACTION_UP:
    if (!myLongClickPerformed) {
      if (myPendingLongClickRunnable != null) {
        removeCallbacks(myPendingLongClickRunnable);
      }
      if (myPendingPress) {
        view.onStylusPress(myPressedX,myPressedY);
      }
      view.onStylusRelease(x,y);
    }
  myPendingPress=false;
myScreenIsTouched=false;
break;
case MotionEvent.ACTION_DOWN:
postLongClickRunnable();
myScreenIsTouched=true;
myPendingPress=true;
myPressedX=x;
myPressedY=y;
break;
case MotionEvent.ACTION_MOVE:
if (!myLongClickPerformed) {
if (myPendingPress) {
final int slop=ViewConfiguration.get(getContext()).getScaledTouchSlop();
if (Math.abs(myPressedX - x) > slop || Math.abs(myPressedY - y) > slop) {
if (myPendingLongClickRunnable != null) {
removeCallbacks(myPendingLongClickRunnable);
}
view.onStylusMovePressed(myPressedX,myPressedY);
myPendingPress=false;
}
}
if (!myPendingPress) {
view.onStylusMovePressed(x,y);
}
}
break;
}
return true;
}

{
  final ArrayList authors=myCollection.authors();
  String currentSequenceName="";
  ZLTextTreeParagraph sequenceParagraph;
  for (int i=0; i < authors.size(); i++) {
    Author it=(Author)authors.get(i);
    final ArrayList books=myCollection.books(it);
    if (!books.isEmpty()) {
      currentSequenceName="";
      sequenceParagraph=null;
      ZLTextTreeParagraph authorParagraph=createParagraph(null);
      insertText(FBTextKind.LIBRARY_AUTHOR_ENTRY,it.getDisplayName());
      for (int j=0; j < books.size(); j++) {
        BookDescription jt=(BookDescription)books.get(j);
        final String sequenceName=jt.getSequenceName();
        if (sequenceName.length() == 0) {
          currentSequenceName="";
          sequenceParagraph=null;
        }
 else         if (sequenceName != currentSequenceName) {
          currentSequenceName=sequenceName;
          sequenceParagraph=createParagraph(authorParagraph);
          insertText(FBTextKind.LIBRARY_BOOK_ENTRY,sequenceName);
        }
        ZLTextTreeParagraph bookParagraph=createParagraph((sequenceParagraph == null) ? authorParagraph : sequenceParagraph);
        insertText(FBTextKind.LIBRARY_BOOK_ENTRY,jt.getTitle());
        insertImage(BookInfoImageId);
        if (myCollection.isBookExternal(jt)) {
          insertImage(RemoveBookImageId);
        }
        myParagraphToBook.put(bookParagraph,jt);
        myBookToParagraph.put(jt,getParagraphsNumber() - 1);
      }
    }
  }
}

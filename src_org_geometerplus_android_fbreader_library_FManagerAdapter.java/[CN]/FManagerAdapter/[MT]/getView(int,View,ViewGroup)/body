{
  final View view=(convertView != null) ? convertView : LayoutInflater.from(parent.getContext()).inflate(R.layout.library_tree_item,parent,false);
  FileItem item=myItems.get(position);
  if (item != null) {
    ((TextView)view.findViewById(R.id.library_tree_item_name)).setText(item.getName());
    ((TextView)view.findViewById(R.id.library_tree_item_childrenlist)).setText(item.getPath());
    if (myCoverWidth == -1) {
      view.measure(ViewGroup.LayoutParams.FILL_PARENT,ViewGroup.LayoutParams.WRAP_CONTENT);
      myCoverHeight=view.getMeasuredHeight();
      myCoverWidth=myCoverHeight * 15 / 32;
      view.requestLayout();
    }
    final ImageView coverView=(ImageView)view.findViewById(R.id.library_tree_item_icon);
    coverView.getLayoutParams().width=myCoverWidth;
    coverView.getLayoutParams().height=myCoverHeight;
    coverView.setScaleType(ImageView.ScaleType.CENTER_INSIDE);
    coverView.requestLayout();
    final ZLImage cover=item.getCover();
    Bitmap coverBitmap=null;
    if (cover != null) {
      System.err.println("cover != null");
      ZLAndroidImageData data=null;
      final ZLAndroidImageManager mgr=(ZLAndroidImageManager)ZLAndroidImageManager.Instance();
      if (cover instanceof ZLLoadableImage) {
        System.err.println("cover instanceof ZLLoadableImage");
        final ZLLoadableImage loadableImage=(ZLLoadableImage)cover;
        if (loadableImage.isSynchronized()) {
          data=mgr.getImageData(loadableImage);
        }
 else {
          System.err.println("startImageLoading");
          ZLAndroidImageLoader.Instance().startImageLoading(loadableImage,myInvalidateViewsRunnable);
        }
      }
 else {
        data=mgr.getImageData(cover);
      }
      if (data != null) {
        Log.v(FileManager.LOG,"data != null");
        coverBitmap=data.getBitmap(2 * myCoverWidth,2 * myCoverHeight);
      }
    }
    if (coverBitmap != null) {
      coverView.setImageBitmap(coverBitmap);
    }
 else {
      coverView.setImageResource(item.getIcon());
    }
  }
  return view;
}

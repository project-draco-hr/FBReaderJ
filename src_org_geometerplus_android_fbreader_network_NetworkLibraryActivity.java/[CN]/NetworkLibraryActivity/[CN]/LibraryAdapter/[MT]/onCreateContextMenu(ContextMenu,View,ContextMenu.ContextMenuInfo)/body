{
  final int position=((AdapterView.AdapterContextMenuInfo)menuInfo).position;
  final NetworkTree tree=(NetworkTree)getItem(position);
  final ZLResource resource=ZLResource.resource("networkView");
  if (tree instanceof NetworkCatalogRootTree) {
    menu.setHeaderTitle(tree.getName());
    if (tree.hasChildren() && isOpen(tree)) {
      menu.add(0,EXPAND_OR_COLLAPSE_TREE_ITEM_ID,0,resource.getResource("closeCatalog").getValue());
    }
 else {
      menu.add(0,EXPAND_OR_COLLAPSE_TREE_ITEM_ID,0,resource.getResource("openCatalog").getValue());
    }
  }
 else   if (tree instanceof NetworkCatalogTree) {
    menu.setHeaderTitle(tree.getName());
    if (tree.hasChildren() && isOpen(tree)) {
      menu.add(0,EXPAND_OR_COLLAPSE_TREE_ITEM_ID,0,resource.getResource("collapseTree").getValue());
    }
 else {
      menu.add(0,EXPAND_OR_COLLAPSE_TREE_ITEM_ID,0,resource.getResource("expandTree").getValue());
    }
  }
 else   if (tree instanceof NetworkBookTree) {
    NetworkBookTree bookTree=(NetworkBookTree)tree;
    NetworkBookItem book=bookTree.Book;
    menu.setHeaderTitle(tree.getName());
    if (book.reference(BookReference.Type.DOWNLOAD_FULL) != null || book.reference(BookReference.Type.DOWNLOAD_FULL_CONDITIONAL) != null) {
      if (book.localCopyFileName() == null && book.reference(BookReference.Type.DOWNLOAD_FULL) != null) {
        menu.add(0,DOWNLOAD_BOOK_ITEM_ID,0,resource.getResource("download").getValue());
      }
    }
    if (book.reference(BookReference.Type.DOWNLOAD_DEMO) != null) {
    }
    if (book.reference(BookReference.Type.BUY) != null) {
    }
 else     if (book.reference(BookReference.Type.BUY_IN_BROWSER) != null) {
    }
  }
}

{
  super.onCreate(icicle);
  BookCollection.bindToService(this,null);
  AuthenticationActivity.initCredentialsCreator(this);
  SQLiteCookieDatabase.init(this);
  setListAdapter(new NetworkLibraryAdapter(this));
  final Intent intent=getIntent();
  init(intent);
  myDeferredIntent=null;
  setDefaultKeyMode(DEFAULT_KEYS_SEARCH_LOCAL);
  if (getCurrentTree() instanceof RootTree) {
    mySingleCatalog=intent.getBooleanExtra("SingleCatalog",false);
    if (!NetworkLibrary.Instance().isInitialized()) {
      Util.initLibrary(this,myNetworkContext,new Runnable(){
        public void run(){
          NetworkLibrary.Instance().runBackgroundUpdate(false);
          if (intent != null) {
            openTreeByIntent(intent);
          }
        }
      }
);
    }
 else {
      NetworkLibrary.Instance().fireModelChangedEvent(NetworkLibrary.ChangeListener.Code.SomeCode);
      openTreeByIntent(intent);
    }
  }
  getListView().setOnScrollListener(this);
}

{
  if (isEmpty()) {
    return;
  }
  final ZLTextElementAreaVector vector=page.TextElementMap;
  final ZLTextElementArea firstArea=vector.getFirstArea();
  final ZLTextElementArea lastArea=vector.getLastArea();
  if (firstArea != null && y < firstArea.YStart) {
    if (myScroller != null && myScroller.scrollsForward()) {
      myScroller.stop();
      myScroller=null;
    }
    if (myScroller == null) {
      myScroller=new Scroller(page,false,x,y);
      return;
    }
  }
 else   if (lastArea != null && y + ZLTextSelectionCursor.getHeight() / 2 + ZLTextSelectionCursor.getAccent() / 2 > lastArea.YEnd) {
    if (myScroller != null && !myScroller.scrollsForward()) {
      myScroller.stop();
      myScroller=null;
    }
    if (myScroller == null) {
      myScroller=new Scroller(page,true,x,y);
      return;
    }
  }
 else {
    if (myScroller != null) {
      myScroller.stop();
      myScroller=null;
    }
  }
  if (myScroller != null) {
    myScroller.setXY(x,y);
  }
  ZLTextRegion region=myView.findRegion(x,y,myView.maxSelectionDistance(),ZLTextRegion.AnyRegionFilter);
  if (region == null && myScroller != null) {
    region=myView.findRegion(x,y,ZLTextRegion.AnyRegionFilter);
  }
  if (region == null) {
    return;
  }
  final ZLTextRegion.Soul soul=region.getSoul();
  if (myCursorInMovement == ZLTextSelectionCursor.Right) {
    if (myLeftMostRegionSoul.compareTo(soul) <= 0) {
      myRightMostRegionSoul=soul;
    }
 else {
      myRightMostRegionSoul=myLeftMostRegionSoul;
      myLeftMostRegionSoul=soul;
      myCursorInMovement=ZLTextSelectionCursor.Left;
    }
  }
 else {
    if (myRightMostRegionSoul.compareTo(soul) >= 0) {
      myLeftMostRegionSoul=soul;
    }
 else {
      myLeftMostRegionSoul=myRightMostRegionSoul;
      myRightMostRegionSoul=soul;
      myCursorInMovement=ZLTextSelectionCursor.Right;
    }
  }
  if (myCursorInMovement == ZLTextSelectionCursor.Right) {
    if (hasPartAfterPage(page)) {
      myView.turnPage(true,ZLTextView.ScrollingMode.SCROLL_LINES,1);
      myView.Application.getViewWidget().reset();
      myView.preparePaintInfo();
    }
  }
 else {
    if (hasPartBeforePage(page)) {
      myView.turnPage(false,ZLTextView.ScrollingMode.SCROLL_LINES,1);
      myView.Application.getViewWidget().reset();
      myView.preparePaintInfo();
    }
  }
}

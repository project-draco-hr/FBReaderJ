{
  tag=tag.toLowerCase();
switch (myReadState) {
case READ_NOTHING:
    if (GUIDE.equals(tag)) {
      myReadState=READ_GUIDE;
    }
 else     if (MANIFEST.equals(tag) && myCoverId != null) {
      myReadState=READ_MANIFEST;
    }
 else     if (testTag(OpenPackagingFormat,"metadata",tag)) {
      myReadState=READ_METADATA;
    }
  break;
case READ_GUIDE:
if ("reference".equals(tag)) {
  final String type=attributes.getValue("type");
  if ("cover" == type) {
    final String href=attributes.getValue("href");
    if (href != null) {
      final ZLFile coverFile=ZLFile.createFileByPath(myPathPrefix + MiscUtil.decodeHtmlReference(href));
      myImage=XHTMLImageFinder.getCoverImage(coverFile);
      return true;
    }
  }
 else   if ("other.ms-coverimage-standard".equals(type)) {
    myImage=imageByHref(attributes.getValue("href"));
    if (myImage != null) {
      return true;
    }
  }
}
break;
case READ_METADATA:
if (testTag(OpenPackagingFormat,"meta",tag)) {
final String name=attributes.getValue("name");
if ("cover".equals(name)) {
myCoverId=attributes.getValue("content");
}
}
break;
case READ_MANIFEST:
if ("item".equals(tag) && myCoverId.equals(attributes.getValue("id"))) {
myImage=imageByHref(attributes.getValue("href"));
if (myImage != null) {
return true;
}
}
break;
}
return false;
}

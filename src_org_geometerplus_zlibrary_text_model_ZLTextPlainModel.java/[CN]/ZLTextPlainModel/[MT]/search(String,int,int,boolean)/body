{
  int count=0;
  ZLSearchPattern pattern=new ZLSearchPattern(text,ignoreCase);
  myMarks=new ArrayList<ZLTextMark>();
  if (startIndex > myParagraphsNumber) {
    startIndex=myParagraphsNumber;
  }
  if (endIndex > myParagraphsNumber) {
    endIndex=myParagraphsNumber;
  }
  int index=startIndex;
  for (EntryIteratorImpl it=new EntryIteratorImpl(index); index < endIndex; it.reset(++index)) {
    int offset=0;
    while (it.hasNext()) {
      it.next();
      if (it.getType() == ZLTextParagraph.Entry.TEXT) {
        char[] textData=it.getTextData();
        int textOffset=it.getTextOffset();
        int textLength=it.getTextLength();
        for (int pos=ZLSearchUtil.find(textData,textOffset,textLength,pattern); pos != -1; pos=ZLSearchUtil.find(textData,textOffset,textLength,pattern,pos + 1)) {
          myMarks.add(new ZLTextMark(index,offset + pos,pattern.getLength()));
          ++count;
        }
        offset+=textLength;
      }
    }
  }
  return count;
}

{
  int dataOffset=myDataOffset;
  char[] data=myStorage.block(myDataIndex);
  if (dataOffset == data.length) {
    data=myStorage.block(++myDataIndex);
    dataOffset=0;
  }
  byte type=(byte)data[dataOffset];
  if (type == 0) {
    data=myStorage.block(++myDataIndex);
    dataOffset=0;
    type=(byte)data[0];
  }
  myType=type;
  ++dataOffset;
switch (type) {
case ZLTextParagraph.Entry.TEXT:
    myTextLength=(int)data[dataOffset++] + (((int)data[dataOffset++]) << 16);
  myTextData=data;
myTextOffset=dataOffset;
dataOffset+=myTextLength;
break;
case ZLTextParagraph.Entry.CONTROL:
{
short kind=(short)data[dataOffset++];
myControlKind=(byte)kind;
myControlIsStart=(kind & 0x0100) == 0x0100;
myHyperlinkType=0;
break;
}
case ZLTextParagraph.Entry.HYPERLINK_CONTROL:
{
short kind=(short)data[dataOffset++];
myControlKind=(byte)kind;
myControlIsStart=true;
myHyperlinkType=(byte)(kind >> 8);
short labelLength=(short)data[dataOffset++];
myHyperlinkId=new String(data,dataOffset,labelLength);
dataOffset+=labelLength;
break;
}
case ZLTextParagraph.Entry.IMAGE:
{
final short vOffset=(short)data[dataOffset++];
final short len=(short)data[dataOffset++];
final String id=new String(data,dataOffset,len);
dataOffset+=len;
final boolean isCover=data[dataOffset++] != 0;
myImageEntry=new ZLImageEntry(myImageMap,id,vOffset,isCover);
break;
}
case ZLTextParagraph.Entry.FIXED_HSPACE:
myFixedHSpaceLength=(short)data[dataOffset++];
break;
case ZLTextParagraph.Entry.STYLE:
{
final int mask=(int)data[dataOffset++];
final ZLTextStyleEntry entry=new ZLTextStyleEntry();
if ((mask & ZLTextStyleEntry.SUPPORTS_LEFT_INDENT) == ZLTextStyleEntry.SUPPORTS_LEFT_INDENT) {
entry.setLeftIndent((short)data[dataOffset++]);
}
if ((mask & ZLTextStyleEntry.SUPPORTS_RIGHT_INDENT) == ZLTextStyleEntry.SUPPORTS_RIGHT_INDENT) {
entry.setRightIndent((short)data[dataOffset++]);
}
if ((mask & ZLTextStyleEntry.SUPPORTS_ALIGNMENT_TYPE) == ZLTextStyleEntry.SUPPORTS_ALIGNMENT_TYPE) {
entry.setAlignmentType((byte)data[dataOffset++]);
}
myStyleEntry=entry;
}
case ZLTextParagraph.Entry.RESET_BIDI:
break;
}
++myCounter;
myDataOffset=dataOffset;
}

{
  final StringBuilder buffer=builder();
  appendTag(buffer,"bookmark",false,"id",String.valueOf(bookmark.getId()),"visible",String.valueOf(bookmark.IsVisible));
  appendTag(buffer,"book",true,"id",String.valueOf(bookmark.getBookId()),"title",bookmark.getBookTitle());
  appendTagWithContent(buffer,"text",bookmark.getText());
  appendTag(buffer,"history",true,"date-creation",formatDate(bookmark.getDate(Bookmark.DateType.Creation)),"date-modification",formatDate(bookmark.getDate(Bookmark.DateType.Modification)),"date-access",formatDate(bookmark.getDate(Bookmark.DateType.Access)));
  appendTag(buffer,"start",true,"model",bookmark.ModelId,"paragraph",String.valueOf(bookmark.getParagraphIndex()),"element",String.valueOf(bookmark.getElementIndex()),"char",String.valueOf(bookmark.getCharIndex()));
  final ZLTextPosition end=bookmark.getEnd();
  if (end != null) {
    appendTag(buffer,"end",true,"paragraph",String.valueOf(end.getParagraphIndex()),"element",String.valueOf(end.getElementIndex()),"char",String.valueOf(end.getCharIndex()));
  }
 else {
    appendTag(buffer,"end",true,"length",String.valueOf(bookmark.getLength()));
  }
  appendTag(buffer,"style",true,"id",String.valueOf(bookmark.getStyleId()));
  closeTag(buffer,"bookmark");
  return buffer.toString();
}

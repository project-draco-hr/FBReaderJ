{
  final boolean hasBuyReference=this.reference(UrlInfo.Type.BookBuy) != null || this.reference(UrlInfo.Type.BookBuyInBrowser) != null;
  BookUrlInfo reference=null;
  String fileName=null;
  for (  BookUrlInfo ref : myReferences) {
    final UrlInfo.Type type=ref.InfoType;
    if ((type == UrlInfo.Type.Book || type == UrlInfo.Type.BookConditional || (!hasBuyReference && type == UrlInfo.Type.BookFullOrDemo)) && (reference == null || ref.BookFormat > reference.BookFormat)) {
      String name=ref.localCopyFileName(UrlInfo.Type.Book);
      if (name != null) {
        reference=ref;
        fileName=name;
      }
    }
  }
  return fileName;
}

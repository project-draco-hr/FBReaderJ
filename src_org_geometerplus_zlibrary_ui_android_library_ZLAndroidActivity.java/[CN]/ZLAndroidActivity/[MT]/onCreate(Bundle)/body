{
  super.onCreate(state);
  Thread.setDefaultUncaughtExceptionHandler(new UncaughtExceptionHandler(this));
  if (state != null) {
    myOrientation=state.getInt(REQUESTED_ORIENTATION_KEY,ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED);
    myChangeCounter=state.getInt(ORIENTATION_CHANGE_COUNTER_KEY);
  }
  requestWindowFeature(Window.FEATURE_NO_TITLE);
  if (getLibrary().DisableButtonLightsOption.getValue()) {
    disableButtonLight();
  }
  setContentView(R.layout.main);
  setDefaultKeyMode(DEFAULT_KEYS_SEARCH_LOCAL);
  getLibrary().setActivity(this);
  final ZLFile fileToOpen=fileFromIntent(getIntent());
  final ZLAndroidApplication androidApplication=(ZLAndroidApplication)getApplication();
  if (androidApplication.myMainWindow == null) {
    final ZLApplication application=createApplication(fileToOpen);
    androidApplication.myMainWindow=new ZLAndroidApplicationWindow(application);
    application.initWindow();
  }
 else {
    ZLApplication.Instance().openFile(fileToOpen);
  }
  ZLApplication.Instance().getViewWidget().repaint();
}

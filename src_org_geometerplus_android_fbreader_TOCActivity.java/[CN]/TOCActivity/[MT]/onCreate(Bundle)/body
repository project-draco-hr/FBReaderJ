{
  super.onCreate(bundle);
  Thread.setDefaultUncaughtExceptionHandler(new org.geometerplus.zlibrary.ui.android.library.UncaughtExceptionHandler(this));
  requestWindowFeature(Window.FEATURE_NO_TITLE);
  final FBReaderApp fbreader=(FBReaderApp)ZLApplication.Instance();
  final TOCTree root=fbreader.Model.TOCTree;
  myAdapter=new TOCAdapter(root);
  final ZLTextWordCursor cursor=fbreader.BookTextView.getStartCursor();
  int index=cursor.getParagraphIndex();
  if (cursor.isEndOfParagraph()) {
    ++index;
  }
  TOCTree treeToSelect=null;
  for (  TOCTree tree : root) {
    final TOCTree.Reference reference=tree.getReference();
    if (reference == null) {
      continue;
    }
    if (reference.ParagraphIndex > index) {
      break;
    }
    treeToSelect=tree;
  }
  myAdapter.selectItem(treeToSelect);
  mySelectedItem=treeToSelect;
}

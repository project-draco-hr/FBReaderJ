{
  final int level=tree.Level - 1;
  if (level > myOpenedStack.size()) {
    throw new RuntimeException("Unable to open catalog with Level greater than the number of opened catalogs.\n" + "Catalog: " + tree.getName() + "\n"+ "Level: "+ level+ "\n"+ "Opened catalogs: "+ myOpenedStack.size());
  }
  while (level < myOpenedStack.size()) {
    final OpenedStackItem item=myOpenedStack.removeLast();
    if (item.Activity != null) {
      throw new RuntimeException("Unable to open catalog when catalog's Level (" + level + ") isn't greater than opened catalog's Level ("+ (item.Tree.Level - 1)+ ")");
    }
  }
  myOpenedStack.add(new OpenedStackItem(tree));
  if (tree instanceof NetworkCatalogTree) {
    context.startActivity(new Intent(context.getApplicationContext(),NetworkCatalogActivity.class).putExtra(NetworkCatalogActivity.CATALOG_LEVEL_KEY,level));
  }
 else {
    throw new RuntimeException("Don't know how to start activity for " + tree.getClass().getName());
  }
}

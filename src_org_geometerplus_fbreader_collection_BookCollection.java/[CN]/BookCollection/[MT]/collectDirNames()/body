{
  ArrayList nameQueue=new ArrayList();
  HashSet nameSet=new HashSet();
  nameQueue.add(BookDirectory);
  while (!nameQueue.isEmpty()) {
    String name=(String)nameQueue.get(0);
    nameQueue.remove(0);
    if (!nameSet.contains(name)) {
      ZLDir dir=new ZLFile(name).getDirectory();
      if (dir != null) {
        ArrayList subdirs=dir.collectSubDirs();
        for (int i=0; i < subdirs.size(); ++i) {
          nameQueue.add(dir.getItemPath((String)subdirs.get(i)));
        }
      }
      nameSet.add(name);
    }
  }
  return nameSet;
}

{
  if (!wallpaperFile.equals(myWallpaperFile)) {
    myWallpaperFile=wallpaperFile;
    myWallpaper=null;
    try {
      final Bitmap fileBitmap=new BitmapFactory().decodeStream(wallpaperFile.getInputStream());
      if (doMirror) {
        final int w=fileBitmap.getWidth();
        final int h=fileBitmap.getHeight();
        final Bitmap wallpaper=Bitmap.createBitmap(2 * w,2 * h,fileBitmap.getConfig());
        for (int i=0; i < w; ++i) {
          for (int j=0; j < h; ++j) {
            int color=fileBitmap.getPixel(i,j);
            wallpaper.setPixel(i,j,color);
            wallpaper.setPixel(i,2 * h - j - 1,color);
            wallpaper.setPixel(2 * w - i - 1,j,color);
            wallpaper.setPixel(2 * w - i - 1,2 * h - j - 1,color);
          }
        }
        myWallpaper=wallpaper;
      }
 else {
        myWallpaper=fileBitmap;
      }
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
  if (myWallpaper != null) {
    final int w=myWallpaper.getWidth();
    final int h=myWallpaper.getHeight();
    for (int cw=0, iw=1; cw < myWidth; cw+=w, ++iw) {
      for (int ch=0, ih=1; ch < myHeight; ch+=h, ++ih) {
        myCanvas.drawBitmap(myWallpaper,cw,ch,myFillPaint);
      }
    }
  }
 else {
    clear(new ZLColor(128,128,128));
  }
}

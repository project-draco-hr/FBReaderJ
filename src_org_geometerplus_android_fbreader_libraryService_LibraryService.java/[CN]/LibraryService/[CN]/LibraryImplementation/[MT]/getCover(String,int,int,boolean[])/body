{
  clearCoversMap();
  final WeakReference<Object> ref=myCoversMap.get(book);
  if (ref != null) {
    final Object bitmap=ref.get();
    if (bitmap != null) {
      delayed[0]=false;
      return bitmap instanceof Bitmap ? (Bitmap)bitmap : null;
    }
  }
  final ZLImage image=myCollection.getCover(SerializerUtil.deserializeBook(book),maxWidth,maxHeight);
  if (image == null) {
    myCoversMap.put(book,new WeakReference<Object>(NULL_COVER));
    delayed[0]=false;
    return null;
  }
  if (image instanceof ZLImageProxy) {
    myImageSynchronizer.synchronize((ZLImageProxy)image,new Runnable(){
      @Override public void run(){
        final ZLAndroidImageManager manager=(ZLAndroidImageManager)ZLAndroidImageManager.Instance();
        final ZLAndroidImageData data=manager.getImageData(image);
        if (data != null) {
          final Bitmap cover=data.getBitmap(maxWidth,maxHeight);
          myCoversMap.put(book,new WeakReference<Object>(cover,myReferenceQueue));
        }
 else {
          myCoversMap.put(book,new WeakReference<Object>(NULL_COVER,myReferenceQueue));
        }
        myCollection.fireBookEvent(BookEvent.CoverSynchronized,SerializerUtil.deserializeBook(book));
      }
    }
);
  }
  final ZLAndroidImageManager manager=(ZLAndroidImageManager)ZLAndroidImageManager.Instance();
  if (((ZLImageProxy)image).isSynchronized()) {
    delayed[0]=true;
    return null;
  }
  delayed[0]=false;
  final ZLAndroidImageData data=manager.getImageData(image);
  return data != null ? data.getBitmap(maxWidth,maxHeight) : null;
}

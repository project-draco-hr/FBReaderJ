{
  if (newWidth <= 0 || newHeight <= 0) {
    return null;
  }
  final int bWidth=bitmap.getWidth();
  final int bHeight=bitmap.getHeight();
  if (newWidth == bWidth && newHeight == bHeight) {
    return bitmap;
  }
  if (newWidth > bWidth && newHeight > bHeight) {
    return null;
  }
  final int w, h;
  if (bWidth * newHeight > bHeight * newWidth) {
    w=newWidth;
    h=Math.max(1,bHeight * w / bWidth);
  }
 else {
    h=newHeight;
    w=Math.max(1,bWidth * h / bHeight);
  }
  if (w == bWidth && h == bHeight) {
    return bitmap;
  }
  return Bitmap.createScaledBitmap(bitmap,w,h,false);
}

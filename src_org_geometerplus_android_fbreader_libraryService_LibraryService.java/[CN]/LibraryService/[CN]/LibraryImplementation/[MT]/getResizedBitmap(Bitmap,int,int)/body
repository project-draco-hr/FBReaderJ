{
  final int bWidth=bitmap.getWidth();
  final int bHeight=bitmap.getHeight();
  if (bWidth <= 0 || bWidth < newWidth || bHeight <= 0 || bHeight < newHeight) {
    return null;
  }
  if (bWidth == newWidth && bHeight == newHeight) {
    return bitmap;
  }
  final int w, h;
  if (bWidth * newHeight > bHeight * newWidth) {
    w=newWidth;
    h=Math.max(1,bHeight * w / bWidth);
  }
 else {
    h=newHeight;
    w=Math.max(1,bWidth * h / bHeight);
  }
  return Bitmap.createScaledBitmap(bitmap,w,h,false);
}

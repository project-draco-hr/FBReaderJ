{
  List<ZLApplication.Toolbar.Item> items=application().getToolbar().items();
  boolean enableToolbarSpace=false;
  ZLApplication.Toolbar.Item lastSeparator=null;
  for (  ZLApplication.Toolbar.Item item : items) {
    if (item instanceof ZLApplication.Toolbar.OptionEntryItem) {
    }
 else     if (item instanceof ZLApplication.Toolbar.ButtonItem) {
      ZLApplication.Toolbar.ButtonItem button=(ZLApplication.Toolbar.ButtonItem)item;
      int id=button.getActionId();
      boolean visible=application().isActionVisible(id);
      boolean enabled=application().isActionEnabled(id);
      if (visible) {
        if (lastSeparator != null) {
          setToolbarItemState(lastSeparator,true,true);
          lastSeparator=null;
        }
        enableToolbarSpace=true;
      }
      if (!enabled && button.isPressed()) {
        ZLApplication.Toolbar.ButtonGroup group=button.getButtonGroup();
        group.press(null);
        application().doAction(group.UnselectAllButtonsActionId);
        myToggleButtonLock=true;
        setToggleButtonState(button);
        myToggleButtonLock=false;
      }
      setToolbarItemState(item,visible,enabled);
    }
 else     if (item instanceof ZLApplication.Toolbar.SeparatorItem) {
      if (enableToolbarSpace) {
        lastSeparator=item;
        enableToolbarSpace=false;
      }
 else {
        setToolbarItemState(item,false,true);
      }
      break;
    }
  }
  if (lastSeparator != null) {
    setToolbarItemState(lastSeparator,false,true);
  }
}

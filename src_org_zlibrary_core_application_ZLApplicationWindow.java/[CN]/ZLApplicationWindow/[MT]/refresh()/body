{
  final ZLApplication.Toolbar toolbar=myApplication.getToolbar();
  if (toolbar != null) {
    boolean enableToolbarSpace=false;
    ZLApplication.Toolbar.Item lastSeparator=null;
    final int size=toolbar.size();
    for (int i=0; i < size; ++i) {
      final ZLApplication.Toolbar.Item item=toolbar.getItem(i);
      if (item instanceof ZLApplication.Toolbar.OptionEntryItem) {
      }
 else       if (item instanceof ZLApplication.Toolbar.ButtonItem) {
        ZLApplication.Toolbar.ButtonItem button=(ZLApplication.Toolbar.ButtonItem)item;
        int id=button.getActionId();
        boolean visible=getApplication().isActionVisible(id);
        boolean enabled=getApplication().isActionEnabled(id);
        if (visible) {
          if (lastSeparator != null) {
            setToolbarItemState(lastSeparator,true,true);
            lastSeparator=null;
          }
          enableToolbarSpace=true;
        }
        if (!enabled && button.isPressed()) {
          ZLApplication.Toolbar.ButtonGroup group=button.getButtonGroup();
          group.press(null);
          getApplication().doAction(group.UnselectAllButtonsActionId);
          myToggleButtonLock=true;
          setToggleButtonState(button);
          myToggleButtonLock=false;
        }
        setToolbarItemState(item,visible,enabled);
      }
 else       if (item instanceof ZLApplication.Toolbar.SeparatorItem) {
        if (enableToolbarSpace) {
          lastSeparator=item;
          enableToolbarSpace=false;
        }
 else {
          setToolbarItemState(item,false,true);
        }
      }
    }
    if (lastSeparator != null) {
      setToolbarItemState(lastSeparator,false,true);
    }
  }
}

{
  final FormatPlugin plugin=PluginCollection.Instance().getPlugin(book.File);
  if (plugin == null) {
    throw new BookReadingException("pluginNotFound",book.File);
  }
  System.err.println("using plugin: " + plugin.supportedFileType() + "/"+ plugin.type());
  final BookModel model;
switch (plugin.type()) {
case NATIVE:
    model=new NativeBookModel(book);
  break;
case JAVA:
model=new JavaBookModel(book);
break;
default :
throw new BookReadingException("unknownPluginType",plugin.type().toString(),null);
}
plugin.readModel(model);
return model;
}

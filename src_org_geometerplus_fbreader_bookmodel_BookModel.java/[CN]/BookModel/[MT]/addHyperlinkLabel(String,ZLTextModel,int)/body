{
  final String modelId=model.getId();
  final int labelLength=label.length();
  final int idLength=(modelId != null) ? modelId.length() : 0;
  final int len=4 + labelLength + idLength;
  char[] block=myCurrentLinkBlock;
  int offset=myCurrentLinkBlockOffset;
  if ((block == null) || (offset + len > block.length)) {
    if (block != null) {
      myInternalHyperlinks.freezeLastBlock();
    }
    block=myInternalHyperlinks.createNewBlock(len);
    myCurrentLinkBlock=block;
    offset=0;
  }
  block[offset++]=(char)labelLength;
  label.getChars(0,labelLength,block,offset);
  offset+=labelLength;
  block[offset++]=(char)idLength;
  if (idLength > 0) {
    modelId.getChars(0,idLength,block,offset);
    offset+=idLength;
  }
  block[offset++]=(char)(paragraphNumber >> 16);
  block[offset++]=(char)paragraphNumber;
  myCurrentLinkBlockOffset=offset;
}

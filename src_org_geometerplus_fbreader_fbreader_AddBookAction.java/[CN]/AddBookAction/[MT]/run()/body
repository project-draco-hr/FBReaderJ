{
  final FBFileHandler handler=new FBFileHandler();
  Runnable actionOnAccept=new Runnable(){
    public void run(){
      final BookDescription description=handler.getDescription();
      if (description == null) {
        return;
      }
      final BookCollection collection=fbreader().getCollectionView().getCollection();
      final String fileName=description.getFileName();
      Runnable action=new Runnable(){
        public void run(){
          fbreader().openFile(fileName);
          collection.rebuild(false);
          new BookList().addFileName(fileName);
          fbreader().setMode(FBReader.ViewMode.BOOK_TEXT);
          fbreader().refreshWindow();
        }
      }
;
      new BookInfoDialog(collection,fileName,action).getDialog().run();
    }
  }
;
  ZLDialogManager.getInstance().runSelectionDialog("addFileDialog",handler,actionOnAccept);
}

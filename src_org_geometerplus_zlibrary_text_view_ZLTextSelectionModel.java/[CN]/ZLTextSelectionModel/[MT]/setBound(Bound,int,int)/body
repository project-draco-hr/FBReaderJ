{
  final ZLTextElementAreaVector areaVector=myView.myCurrentPage.TextElementMap;
  if (areaVector.isEmpty()) {
    return;
  }
  final int areaVectorSize=areaVector.size();
  int areaIndex=0;
  ZLTextElementArea area=null;
  for (; areaIndex < areaVectorSize; ++areaIndex) {
    area=areaVector.get(areaIndex);
    if ((area.YStart > y) || ((area.YEnd > y) && (area.XEnd > x))) {
      break;
    }
  }
  final ZLTextElementArea elementArea=area;
  if (areaIndex < areaVectorSize) {
    bound.After.ParagraphIndex=elementArea.ParagraphIndex;
    bound.After.ElementIndex=elementArea.ElementIndex;
    bound.After.Exists=true;
    bound.After.CharIndex=elementArea.CharIndex;
    if (elementArea.contains(x,y)) {
      bound.Before.ParagraphIndex=bound.After.ParagraphIndex;
      bound.Before.ElementIndex=bound.After.ElementIndex;
      bound.Before.Exists=true;
      if (elementArea.Element instanceof ZLTextWord) {
        myView.setTextStyle(elementArea.Style);
        final ZLTextWord word=(ZLTextWord)elementArea.Element;
        final int deltaX=x - elementArea.XStart;
        final int start=elementArea.CharIndex;
        final int len=elementArea.Length;
        int diff=deltaX;
        int previousDiff=diff;
        int index;
        for (index=0; (index < len) && (diff > 0); ++index) {
          previousDiff=diff;
          diff=deltaX - myView.getWordWidth(word,start,index + 1);
        }
        if (previousDiff + diff < 0) {
          --index;
        }
        bound.After.CharIndex=start + index;
        bound.Before.CharIndex=bound.After.CharIndex;
      }
    }
 else     if (areaIndex == 0) {
      bound.Before.Exists=false;
    }
 else {
      final ZLTextElementArea previous=areaVector.get(areaIndex - 1);
      bound.Before.ParagraphIndex=previous.ParagraphIndex;
      bound.Before.ElementIndex=previous.ElementIndex;
      bound.Before.CharIndex=previous.CharIndex + previous.Length;
      bound.Before.Exists=true;
    }
  }
 else {
    bound.Before.ParagraphIndex=elementArea.ParagraphIndex;
    bound.Before.ElementIndex=elementArea.ElementIndex;
    bound.Before.CharIndex=elementArea.CharIndex + elementArea.Length;
    bound.Before.Exists=true;
    bound.After.Exists=false;
  }
}

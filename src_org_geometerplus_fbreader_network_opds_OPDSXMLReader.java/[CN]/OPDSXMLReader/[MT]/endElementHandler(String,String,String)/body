{
  boolean interruptReading=false;
switch (myState) {
case START:
    break;
case FEED:
  if (tagPrefix == myAtomNamespaceId && tag == TAG_FEED) {
    if (myFeed != null) {
      if (myFeed instanceof OPDSFeedMetadata) {
        interruptReading=myFeedReader.processFeedMetadata((OPDSFeedMetadata)myFeed,false);
      }
 else {
        Log.v(OPDS_LOG,"! (myFeed instanceof OPDSFeedMetadata)");
      }
    }
    myFeed=null;
    myFeedReader.processFeedEnd();
    myState=START;
  }
break;
case F_ENTRY:
if (tagPrefix == myAtomNamespaceId && tag == TAG_ENTRY) {
if (myEntry != null) {
  if (myEntry instanceof OPDSEntry) {
    OPDSEntry entry=(OPDSEntry)myEntry;
    interruptReading=myFeedReader.processFeedEntry(entry);
  }
 else {
    Log.v(OPDS_LOG,"! (myEntry instanceof OPDSEntry)");
  }
}
myEntry=null;
myState=FEED;
}
break;
case F_ID:
if (tagPrefix == myAtomNamespaceId && tag == TAG_ID) {
if (bufferContent != null && myFeed != null) {
myId.Uri=bufferContent;
myFeed.Id=myId;
}
myId=null;
myState=FEED;
}
break;
case F_ICON:
if (tagPrefix == myAtomNamespaceId && tag == TAG_ICON) {
if (bufferContent != null && myFeed != null) {
myIcon.Uri=bufferContent;
myFeed.Icon=myIcon;
}
myIcon=null;
myState=FEED;
}
break;
case F_LINK:
if (tagPrefix == myAtomNamespaceId && tag == TAG_LINK) {
if (myFeed != null) {
myFeed.Links.add(myLink);
}
myLink=null;
myState=FEED;
}
break;
case F_CATEGORY:
if (tagPrefix == myAtomNamespaceId && tag == TAG_CATEGORY) {
if (myFeed != null) {
myFeed.Categories.add(myCategory);
}
myCategory=null;
myState=FEED;
}
break;
case F_TITLE:
if (tagPrefix == myAtomNamespaceId && tag == TAG_TITLE) {
final String title=myHtmlToString.finishTextContent(bufferContent);
if (myFeed != null) {
myFeed.Title=title;
}
myState=FEED;
}
 else {
myHtmlToString.processTextContent(true,tag,null,bufferContent);
}
break;
case F_SUBTITLE:
if (tagPrefix == myAtomNamespaceId && tag == TAG_SUBTITLE) {
final String subtitle=myHtmlToString.finishTextContent(bufferContent);
if (myFeed != null) {
myFeed.Subtitle=subtitle;
}
myState=FEED;
}
 else {
myHtmlToString.processTextContent(true,tag,null,bufferContent);
}
break;
case F_UPDATED:
if (tagPrefix == myAtomNamespaceId && tag == TAG_UPDATED) {
if (ATOMDateConstruct.parse(bufferContent,myUpdated) && myFeed != null) {
myFeed.Updated=myUpdated;
}
myUpdated=null;
myState=FEED;
}
break;
case F_AUTHOR:
if (tagPrefix == myAtomNamespaceId && tag == TAG_AUTHOR) {
if (myFeed != null && myAuthor.Name != null) {
myFeed.Authors.add(myAuthor);
}
myAuthor=null;
myState=FEED;
}
break;
case FA_NAME:
if (tagPrefix == myAtomNamespaceId && tag == TAG_NAME) {
myAuthor.Name=bufferContent;
myState=F_AUTHOR;
}
break;
case FEA_NAME:
if (tagPrefix == myAtomNamespaceId && tag == TAG_NAME) {
myAuthor.Name=bufferContent;
myState=FE_AUTHOR;
}
break;
case FA_URI:
if (tagPrefix == myAtomNamespaceId && tag == TAG_URI) {
myAuthor.Uri=bufferContent;
myState=F_AUTHOR;
}
break;
case FEA_URI:
if (tagPrefix == myAtomNamespaceId && tag == TAG_URI) {
myAuthor.Uri=bufferContent;
myState=FE_AUTHOR;
}
break;
case FA_EMAIL:
if (tagPrefix == myAtomNamespaceId && tag == TAG_EMAIL) {
myAuthor.Email=bufferContent;
myState=F_AUTHOR;
}
break;
case FEA_EMAIL:
if (tagPrefix == myAtomNamespaceId && tag == TAG_EMAIL) {
myAuthor.Email=bufferContent;
myState=FE_AUTHOR;
}
break;
case FEL_PRICE:
if (tagPrefix == myOpdsNamespaceId && tag == TAG_PRICE) {
if (bufferContent != null && myPriceCurrency != null) {
if (myLink instanceof OPDSLink) {
((OPDSLink)myLink).Prices.add(new OPDSPrice(bufferContent.intern(),myPriceCurrency));
myPriceCurrency=null;
}
 else {
Log.v(OPDS_LOG,"! (myLink instanceof OPDSLink)");
}
}
myState=FE_LINK;
}
break;
case FEL_FORMAT:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_FORMAT) {
if (bufferContent != null) {
if (myLink instanceof OPDSLink) {
((OPDSLink)myLink).Formats.add(bufferContent.intern());
}
 else {
Log.v(OPDS_LOG,"! (myLink instanceof OPDSLink)");
}
}
myState=FE_LINK;
}
break;
case FE_AUTHOR:
if (tagPrefix == myAtomNamespaceId && tag == TAG_AUTHOR) {
if (myAuthor.Name != null) {
myEntry.Authors.add(myAuthor);
}
myAuthor=null;
myState=F_ENTRY;
}
break;
case FE_ID:
if (tagPrefix == myAtomNamespaceId && tag == TAG_ID) {
if (bufferContent != null) {
myId.Uri=bufferContent;
myEntry.Id=myId;
}
myId=null;
myState=F_ENTRY;
}
break;
case FE_CATEGORY:
if (tagPrefix == myAtomNamespaceId && tag == TAG_CATEGORY) {
myEntry.Categories.add(myCategory);
myCategory=null;
myState=F_ENTRY;
}
break;
case FE_LINK:
if (tagPrefix == myAtomNamespaceId && tag == TAG_LINK) {
myEntry.Links.add(myLink);
myLink=null;
myState=F_ENTRY;
}
break;
case FE_PUBLISHED:
if (tagPrefix == myAtomNamespaceId && tag == TAG_PUBLISHED) {
if (ATOMDateConstruct.parse(bufferContent,myPublished)) {
myEntry.Published=myPublished;
}
myPublished=null;
myState=F_ENTRY;
}
break;
case FE_SUMMARY:
if (tagPrefix == myAtomNamespaceId && tag == TAG_SUMMARY) {
myEntry.Summary=myHtmlToString.finishTextContent(bufferContent);
myState=F_ENTRY;
}
 else {
myHtmlToString.processTextContent(true,tag,null,bufferContent);
}
break;
case FE_CONTENT:
if (tagPrefix == myAtomNamespaceId && tag == TAG_CONTENT) {
myEntry.Content=myHtmlToString.finishTextContent(bufferContent);
myState=F_ENTRY;
}
 else {
myHtmlToString.processTextContent(true,tag,null,bufferContent);
}
break;
case FE_TITLE:
if (tagPrefix == myAtomNamespaceId && tag == TAG_TITLE) {
myEntry.Title=myHtmlToString.finishTextContent(bufferContent);
myState=F_ENTRY;
}
 else {
myHtmlToString.processTextContent(true,tag,null,bufferContent);
}
break;
case FE_UPDATED:
if (tagPrefix == myAtomNamespaceId && tag == TAG_UPDATED) {
if (ATOMDateConstruct.parse(bufferContent,myUpdated)) {
myEntry.Updated=myUpdated;
}
myUpdated=null;
myState=F_ENTRY;
}
break;
case FEC_HACK_SPAN:
myHtmlToString.processTextContent(true,tag,null,bufferContent);
if (bufferContent != null) {
myEntry.addAttribute(KEY_PRICE,bufferContent.intern());
}
myState=FE_CONTENT;
break;
case FE_DC_LANGUAGE:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_LANGUAGE) {
if (myEntry instanceof OPDSEntry) {
((OPDSEntry)myEntry).DCLanguage=bufferContent;
myState=F_ENTRY;
}
 else {
Log.v(OPDS_LOG,"! (myEntry instanceof OPDSEntry)");
}
}
break;
case FE_DC_ISSUED:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_ISSUED) {
if (ATOMDateConstruct.parse(bufferContent,myDCIssued)) {
if (myEntry instanceof OPDSEntry) {
((OPDSEntry)myEntry).DCIssued=myDCIssued;
}
 else {
Log.v(OPDS_LOG,"! (myEntry instanceof OPDSEntry)");
}
}
myDCIssued=null;
myState=F_ENTRY;
}
break;
case FE_DC_PUBLISHER:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_PUBLISHER) {
if (myEntry instanceof OPDSEntry) {
((OPDSEntry)myEntry).DCPublisher=bufferContent;
myState=F_ENTRY;
}
 else {
Log.v(OPDS_LOG,"! (myEntry instanceof OPDSEntry)");
}
}
break;
case FE_CALIBRE_SERIES:
if (tagPrefix == myCalibreNamespaceId && tag == CALIBRE_TAG_SERIES) {
if (myEntry instanceof OPDSEntry) {
((OPDSEntry)myEntry).SeriesTitle=bufferContent;
myState=F_ENTRY;
}
 else {
Log.v(OPDS_LOG,"! (myEntry instanceof OPDSEntry)");
}
}
break;
case FE_CALIBRE_SERIES_INDEX:
if (tagPrefix == myCalibreNamespaceId && tag == CALIBRE_TAG_SERIES_INDEX) {
if (bufferContent != null) {
try {
if (myEntry instanceof OPDSEntry) {
((OPDSEntry)myEntry).SeriesIndex=Float.parseFloat(bufferContent);
}
 else {
Log.v(OPDS_LOG,"! (myEntry instanceof OPDSEntry)");
}
}
 catch (NumberFormatException ex) {
}
}
myState=F_ENTRY;
}
break;
case OPENSEARCH_TOTALRESULTS:
if (tagPrefix == myOpenSearchNamespaceId && tag == OPENSEARCH_TAG_TOTALRESULTS) {
if (myFeed != null && bufferContent != null) {
try {
if (myFeed instanceof OPDSFeedMetadata) {
((OPDSFeedMetadata)myFeed).OpensearchTotalResults=Integer.parseInt(bufferContent);
}
 else {
Log.v(OPDS_LOG,"! (myFeed instanceof OPDSFeedMetadata)");
}
}
 catch (NumberFormatException ex) {
}
}
myState=FEED;
}
break;
case OPENSEARCH_ITEMSPERPAGE:
if (tagPrefix == myOpenSearchNamespaceId && tag == OPENSEARCH_TAG_ITEMSPERPAGE) {
if (myFeed != null && bufferContent != null) {
try {
if (myFeed instanceof OPDSFeedMetadata) {
((OPDSFeedMetadata)myFeed).OpensearchItemsPerPage=Integer.parseInt(bufferContent);
}
 else {
Log.v(OPDS_LOG,"! (myFeed instanceof OPDSFeedMetadata)");
}
}
 catch (NumberFormatException ex) {
}
}
myState=FEED;
}
break;
case OPENSEARCH_STARTINDEX:
if (tagPrefix == myOpenSearchNamespaceId && tag == OPENSEARCH_TAG_STARTINDEX) {
if (myFeed != null && bufferContent != null) {
try {
if (myFeed instanceof OPDSFeedMetadata) {
((OPDSFeedMetadata)myFeed).OpensearchStartIndex=Integer.parseInt(bufferContent);
}
 else {
Log.v(OPDS_LOG,"! (myFeed instanceof OPDSFeedMetadata)");
}
}
 catch (NumberFormatException ex) {
}
}
myState=FEED;
}
break;
}
return interruptReading;
}

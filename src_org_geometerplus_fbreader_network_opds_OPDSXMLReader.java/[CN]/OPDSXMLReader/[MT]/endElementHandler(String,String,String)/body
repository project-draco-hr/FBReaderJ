{
  boolean interruptReading=super.endElementHandler(tagPrefix,tag,bufferContent);
switch (myState) {
case FEL_PRICE:
    if (tagPrefix == myOpdsNamespaceId && tag == TAG_PRICE) {
      if (bufferContent != null && myPriceCurrency != null) {
        getOPDSLink().Prices.add(new OPDSPrice(bufferContent.intern(),myPriceCurrency));
        myPriceCurrency=null;
      }
      myState=FE_LINK;
    }
  break;
case FEL_FORMAT:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_FORMAT) {
  if (bufferContent != null) {
    getOPDSLink().Formats.add(bufferContent.intern());
  }
  myState=FE_LINK;
}
break;
case FEC_HACK_SPAN:
myHtmlToString.processTextContent(true,tag,null,bufferContent);
if (bufferContent != null) {
getOPDSEntry().addAttribute(KEY_PRICE,bufferContent.intern());
}
myState=FE_CONTENT;
break;
case FE_DC_LANGUAGE:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_LANGUAGE) {
getOPDSEntry().DCLanguage=bufferContent;
myState=F_ENTRY;
}
break;
case FE_DC_ISSUED:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_ISSUED) {
if (ATOMDateConstruct.parse(bufferContent,myDCIssued)) {
getOPDSEntry().DCIssued=myDCIssued;
}
myDCIssued=null;
myState=F_ENTRY;
}
break;
case FE_DC_PUBLISHER:
if (tagPrefix == myDublinCoreNamespaceId && tag == DC_TAG_PUBLISHER) {
getOPDSEntry().DCPublisher=bufferContent;
myState=F_ENTRY;
}
break;
case FE_CALIBRE_SERIES:
if (tagPrefix == myCalibreNamespaceId && tag == CALIBRE_TAG_SERIES) {
getOPDSEntry().SeriesTitle=bufferContent;
myState=F_ENTRY;
}
break;
case FE_CALIBRE_SERIES_INDEX:
if (tagPrefix == myCalibreNamespaceId && tag == CALIBRE_TAG_SERIES_INDEX) {
if (bufferContent != null) {
try {
getOPDSEntry().SeriesIndex=Float.parseFloat(bufferContent);
}
 catch (NumberFormatException ex) {
}
}
myState=F_ENTRY;
}
break;
case OPENSEARCH_TOTALRESULTS:
if (tagPrefix == myOpenSearchNamespaceId && tag == OPENSEARCH_TAG_TOTALRESULTS) {
if (getOPDSFeed() != null && bufferContent != null) {
try {
getOPDSFeed().OpensearchTotalResults=Integer.parseInt(bufferContent);
}
 catch (NumberFormatException ex) {
}
}
myState=FEED;
}
break;
case OPENSEARCH_ITEMSPERPAGE:
if (tagPrefix == myOpenSearchNamespaceId && tag == OPENSEARCH_TAG_ITEMSPERPAGE) {
if (getOPDSFeed() != null && bufferContent != null) {
try {
getOPDSFeed().OpensearchItemsPerPage=Integer.parseInt(bufferContent);
}
 catch (NumberFormatException ex) {
}
}
myState=FEED;
}
break;
case OPENSEARCH_STARTINDEX:
if (tagPrefix == myOpenSearchNamespaceId && tag == OPENSEARCH_TAG_STARTINDEX) {
if (getOPDSFeed() != null && bufferContent != null) {
try {
getOPDSFeed().OpensearchStartIndex=Integer.parseInt(bufferContent);
}
 catch (NumberFormatException ex) {
}
}
myState=FEED;
}
break;
}
return interruptReading;
}

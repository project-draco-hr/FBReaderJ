{
  final Runnable scanRunnable=new Runnable(){
    public void run(){
      final ArrayList<ServiceInfoItem> services=new ArrayList<ServiceInfoItem>();
      String errorText=null;
      try {
        final List<InetAddress> addresses=getLocalIpAddresses();
        if (addresses.isEmpty()) {
          errorText=myResource.getResource("noLocalConnection").getValue();
        }
 else {
          for (          InetAddress address : addresses) {
            final JmDNS mcDNS=JmDNS.create(address,"FBReader");
            for (            String type : ourServiceTypes) {
              for (              ServiceInfo info : mcDNS.list(type)) {
                services.add(new ServiceInfoItem(info));
              }
            }
            mcDNS.close();
          }
          if (services.isEmpty()) {
            errorText=myResource.getResource("noCatalogsFound").getValue();
          }
        }
      }
 catch (      Exception e) {
        errorText=e.getMessage();
      }
      setup(services,errorText);
    }
  }
;
  UIUtil.wait("scanningLocalNetwork",scanRunnable,this);
}

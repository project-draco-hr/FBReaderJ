{
  final ZLTextParagraphCursor paragraphCursor=cursor.getParagraphCursor();
  final int endElementIndex=beforeCurrentPosition ? cursor.getElementIndex() : paragraphCursor.getParagraphLength();
  resetTextStyle();
  int size=0;
  int wordIndex=0;
  int charIndex=0;
  while (wordIndex != endElementIndex) {
    ZLTextLineInfo info=processTextLine(paragraphCursor,wordIndex,charIndex,endElementIndex);
    wordIndex=info.EndElementIndex;
    charIndex=info.EndCharIndex;
    size+=infoSize(info,unit);
  }
  return size;
}

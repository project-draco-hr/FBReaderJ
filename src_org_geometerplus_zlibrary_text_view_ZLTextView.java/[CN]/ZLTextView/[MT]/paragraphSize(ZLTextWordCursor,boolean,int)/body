{
  final ZLTextParagraphCursor paragraphCursor=cursor.getParagraphCursor();
  final int endWordIndex=beforeCurrentPosition ? cursor.getWordIndex() : paragraphCursor.getParagraphLength();
  resetTextStyle();
  int size=0;
  int wordIndex=0;
  int charIndex=0;
  while (wordIndex != endWordIndex) {
    ZLTextLineInfo info=processTextLine(paragraphCursor,wordIndex,charIndex,endWordIndex);
    wordIndex=info.EndWordIndex;
    charIndex=info.EndCharIndex;
    size+=infoSize(info,unit);
  }
  return size;
}

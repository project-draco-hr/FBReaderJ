{
  if (!highlighting.isEmpty() && from != to) {
    final ZLTextElementArea fromArea=page.TextElementMap.get(from);
    final ZLTextElementArea toArea=page.TextElementMap.get(to - 1);
    final ZLTextElementArea selectionStartArea=highlighting.getStartArea(page);
    final ZLTextElementArea selectionEndArea=highlighting.getEndArea(page);
    if (selectionStartArea != null && selectionEndArea != null && selectionStartArea.compareTo(toArea) <= 0 && selectionEndArea.compareTo(fromArea) >= 0) {
      final int top=y + 1;
      int left, right, bottom=y + info.Height + info.Descent;
      if (selectionStartArea.compareTo(fromArea) < 0) {
        left=x;
      }
 else {
        left=selectionStartArea.XStart;
      }
      if (selectionEndArea.compareTo(toArea) > 0) {
        right=x + page.getTextWidth() - 1;
        bottom+=info.VSpaceAfter;
      }
 else {
        right=selectionEndArea.XEnd;
      }
      getContext().setFillColor(highlighting.getBackgroundColor());
      getContext().fillRectangle(left,top,right,bottom);
    }
  }
}

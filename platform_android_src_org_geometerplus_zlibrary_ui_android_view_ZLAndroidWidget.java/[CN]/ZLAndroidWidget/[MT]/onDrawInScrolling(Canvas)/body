{
  final int w=getWidth();
  final int h=getHeight();
  final ZLAndroidPaintContext context=ZLAndroidPaintContext.Instance();
  boolean stopScrolling=false;
  if (myScrollingInProgress) {
    myScrollingShift+=(int)myScrollingSpeed;
    if (myScrollingSpeed > 0) {
      if (myScrollingShift >= myScrollingBound) {
        myScrollingShift=myScrollingBound;
        stopScrolling=true;
      }
    }
 else {
      if (myScrollingShift <= myScrollingBound) {
        myScrollingShift=myScrollingBound;
        stopScrolling=true;
      }
    }
    myScrollingSpeed*=1.5;
  }
  final boolean horizontal=(myViewPageToScroll == ZLView.PAGE_RIGHT) || (myViewPageToScroll == ZLView.PAGE_LEFT);
  canvas.drawBitmap(myMainBitmap,horizontal ? myScrollingShift : 0,horizontal ? 0 : myScrollingShift,context.Paint);
  final int size=horizontal ? w : h;
  int shift=(myScrollingShift < 0) ? (myScrollingShift + size) : (myScrollingShift - size);
  canvas.drawBitmap(mySecondaryBitmap,horizontal ? shift : 0,horizontal ? 0 : shift,context.Paint);
  if (stopScrolling) {
    final ZLView view=ZLApplication.Instance().getCurrentView();
    if (myScrollingBound != 0) {
      Bitmap swap=myMainBitmap;
      myMainBitmap=mySecondaryBitmap;
      mySecondaryBitmap=swap;
      mySecondaryBitmapIsUpToDate=false;
      view.onScrollingFinished(myViewPageToScroll);
      ZLApplication.Instance().onRepaintFinished();
    }
 else {
      view.onScrollingFinished(ZLView.PAGE_CENTRAL);
    }
    setPageToScroll(ZLView.PAGE_CENTRAL);
    myScrollingInProgress=false;
    myScrollingShift=0;
  }
 else {
    if (shift < 0) {
      shift+=size;
    }
    if (horizontal) {
      canvas.drawLine(shift,0,shift,h + 1,context.Paint);
    }
 else {
      canvas.drawLine(0,shift,w + 1,shift,context.Paint);
    }
    if (myScrollingInProgress) {
      postInvalidate();
    }
  }
}

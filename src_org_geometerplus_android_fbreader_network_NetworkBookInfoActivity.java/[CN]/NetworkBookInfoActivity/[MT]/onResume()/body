{
  super.onResume();
  final NetworkLibrary library=NetworkLibrary.Instance();
  if (!library.isInitialized()) {
    try {
      if (SQLiteNetworkDatabase.Instance() == null) {
        new SQLiteNetworkDatabase();
      }
      library.initialize();
    }
 catch (    ZLNetworkException e) {
    }
  }
  if (myBook == null) {
    final Uri url=getIntent().getData();
    if (url != null && "litres-book".equals(url.getScheme())) {
      myBook=OPDSBookItem.create(NetworkLibrary.Instance().getLinkBySiteName("litres.ru"),url.toString().replace("litres-book://","http://"));
    }
 else {
      final NetworkTree tree=Util.getTreeFromIntent(getIntent());
      if (tree instanceof NetworkBookTree) {
        myBook=((NetworkBookTree)tree).Book;
      }
    }
    if (myBook == null) {
      finish();
      return;
    }
    myConnection=new BookDownloaderServiceConnection();
    bindService(new Intent(getApplicationContext(),BookDownloaderService.class),myConnection,BIND_AUTO_CREATE);
    setTitle(myBook.Title);
    setupDescription();
    setupExtraLinks();
    setupInfo();
    setupCover();
    setupButtons();
  }
}

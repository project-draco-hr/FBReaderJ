{
  if (super.onStylusPress(x,y)) {
    return true;
  }
  if (isScrollingActive()) {
    return false;
  }
  ZLTextElementArea area=getElementByCoordinates(x,y);
  if (area != null) {
    ZLTextElement element=area.Element;
    if ((element instanceof ZLTextImageElement) || (element instanceof ZLTextWord)) {
      final ZLTextWordCursor cursor=new ZLTextWordCursor(getStartCursor());
      cursor.moveToParagraph(area.ParagraphIndex);
      cursor.moveToParagraphStart();
      final int elementIndex=area.ElementIndex;
      byte hyperlinkKind=FBTextKind.REGULAR;
      String id=null;
      for (int i=0; i < elementIndex; ++i) {
        ZLTextElement e=cursor.getElement();
        if (e instanceof ZLTextControlElement) {
          if (e instanceof ZLTextHyperlinkControlElement) {
            final ZLTextHyperlinkControlElement control=(ZLTextHyperlinkControlElement)e;
            hyperlinkKind=control.Kind;
            id=control.Label;
          }
 else {
            final ZLTextControlElement control=(ZLTextControlElement)e;
            if (!control.IsStart && (control.Kind == hyperlinkKind)) {
              hyperlinkKind=FBTextKind.REGULAR;
              id=null;
            }
          }
        }
        cursor.nextWord();
      }
      if (id != null) {
switch (hyperlinkKind) {
case FBTextKind.EXTERNAL_HYPERLINK:
          ZLibrary.Instance().openInBrowser(id);
        return true;
case FBTextKind.FOOTNOTE:
case FBTextKind.INTERNAL_HYPERLINK:
      ((FBReader)ZLApplication.Instance()).tryOpenFootnote(id);
    return true;
}
}
}
}
final ScrollingPreferences preferences=ScrollingPreferences.Instance();
if (preferences.FlickOption.getValue()) {
myStartX=x;
myStartY=y;
setScrollingActive(true);
myIsManualScrollingActive=true;
}
 else {
if (preferences.HorizontalOption.getValue()) {
if (x <= Context.getWidth() / 3) {
doScrollPage(false);
}
 else if (x >= Context.getWidth() * 2 / 3) {
doScrollPage(true);
}
}
 else {
if (y <= Context.getHeight() / 3) {
doScrollPage(false);
}
 else if (y >= Context.getHeight() * 2 / 3) {
doScrollPage(true);
}
}
}
return true;
}
